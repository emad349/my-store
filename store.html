<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title id="pgTitle">Ù…ØªØ¬Ø±ÙŠ</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --p:#7c3aed;--p2:#6d28d9;
  --s:#2563eb;--s2:#1d4ed8;
  --nv:#0d1035;--nv2:#141847;
  --ac:#a78bfa;
  --gr:#64748b;--bd:#e2e8f0;
  --tx:#1e293b;--tx2:#475569;
  --st:#f59e0b;--re:#ef4444;--gn:#10b981;
  --bg:#f8f7ff;--fbg:#0d1035;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Cairo',sans-serif;background:var(--bg);color:var(--tx);direction:rtl;}
#announceBar{overflow:hidden;height:36px;display:flex;align-items:center;}
.atrack{display:flex;animation:sc 28s linear infinite;white-space:nowrap;gap:3rem;}
@keyframes sc{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
.ait{padding:0 1.2rem;font-size:.82rem;color:#fff;}
header{background:#fff;border-bottom:1px solid var(--bd);position:sticky;top:0;z-index:200;box-shadow:0 1px 10px rgba(0,0,0,.06);}
.htop{display:flex;align-items:center;justify-content:space-between;padding:0 2rem;height:68px;max-width:1280px;margin:0 auto;gap:1rem;}
.logo{display:flex;align-items:center;gap:.7rem;cursor:pointer;text-decoration:none;}
.logo-icon{width:42px;height:42px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.3rem;font-weight:900;flex-shrink:0;overflow:hidden;}
.logo-icon img{width:100%;height:100%;object-fit:cover;}
.logo-name{font-size:1.35rem;font-weight:900;color:var(--nv);line-height:1.1;}
.logo-tag{font-size:.68rem;color:var(--gr);}
.hsearch{flex:1;max-width:480px;position:relative;}
.hsearch input{width:100%;border:1.5px solid var(--bd);border-radius:10px;padding:.6rem 1rem .6rem 2.8rem;font-family:'Cairo',sans-serif;font-size:.9rem;outline:none;background:var(--bg);transition:border-color .2s;}
.hsearch input:focus{border-color:var(--p);}
.hsi{position:absolute;left:10px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:var(--gr);}
.hactions{display:flex;align-items:center;gap:.5rem;}
.hbtn{background:none;border:1px solid var(--bd);color:var(--tx);padding:.45rem .85rem;border-radius:9px;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.84rem;font-weight:600;display:inline-flex;align-items:center;gap:.3rem;transition:all .2s;white-space:nowrap;text-decoration:none;}
.hbtn:hover{border-color:var(--p);color:var(--p);}
.hbtn.primary{background:linear-gradient(135deg,var(--p),var(--s));color:#fff;border:none;}
.hbtn.primary:hover{opacity:.9;}
.cc{background:#fff;color:var(--p);font-size:.7rem;font-weight:900;width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;}
.hnav{border-top:1px solid var(--bd);}
.hnav ul{display:flex;list-style:none;padding:0 2rem;max-width:1280px;margin:0 auto;overflow-x:auto;}
.hnav a{display:flex;align-items:center;gap:.3rem;padding:.6rem 1rem;color:var(--tx2);text-decoration:none;font-size:.87rem;font-weight:600;white-space:nowrap;border-bottom:2px solid transparent;transition:all .2s;}
.hnav a:hover,.hnav a.act{color:var(--p);border-bottom-color:var(--p);}
.cnt{max-width:1280px;margin:0 auto;padding:0 1.5rem;}
.sec{padding:2.5rem 0;}
.sec-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;}
.sec-ttl{font-size:1.25rem;font-weight:800;color:var(--nv);display:flex;align-items:center;gap:.5rem;}
.sec-ttl::before{content:'';display:inline-block;width:4px;height:1.1em;background:linear-gradient(var(--p),var(--s));border-radius:4px;}
.see-all{color:var(--p);font-size:.85rem;font-weight:700;cursor:pointer;border:1px solid rgba(109,40,217,.2);padding:.35rem .9rem;border-radius:7px;background:none;}
.hero{position:relative;display:flex;align-items:center;min-height:380px;padding:3rem 4rem;overflow:hidden;}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse 60% 80% at 80% 50%,rgba(109,40,217,.4),transparent),radial-gradient(ellipse 40% 60% at 20% 80%,rgba(37,99,235,.3),transparent);}
.hcnt{position:relative;z-index:1;max-width:520px;}
.htag{display:inline-flex;align-items:center;background:rgba(167,139,250,.15);border:1px solid rgba(167,139,250,.3);color:var(--ac);font-size:.82rem;padding:.3rem .8rem;border-radius:50px;margin-bottom:1rem;}
.htitle{font-size:2.4rem;font-weight:900;color:#fff;line-height:1.2;margin-bottom:.8rem;}
.htitle .hl{background:linear-gradient(135deg,var(--ac),#60a5fa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
.hdesc{color:rgba(255,255,255,.7);font-size:.95rem;margin-bottom:1.8rem;line-height:1.7;}
.hbtns{display:flex;gap:.8rem;flex-wrap:wrap;}
.hbp{border:none;padding:.75rem 1.8rem;border-radius:10px;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.95rem;font-weight:700;background:linear-gradient(135deg,var(--p),var(--s));color:#fff;transition:all .2s;}
.hbp:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(109,40,217,.4);}
.hbs{background:rgba(255,255,255,.1);color:#fff;border:1px solid rgba(255,255,255,.2);padding:.75rem 1.8rem;border-radius:10px;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.95rem;font-weight:600;transition:all .2s;}
.hbs:hover{background:rgba(255,255,255,.18);}
.hstats{display:flex;gap:2rem;margin-top:2rem;}
.hsn{font-size:1.4rem;font-weight:900;color:#fff;}
.hsl{font-size:.78rem;color:rgba(255,255,255,.5);}
.hdeco{position:absolute;left:3rem;top:50%;transform:translateY(-50%);font-size:10rem;opacity:.07;pointer-events:none;}
.trust{background:#fff;border:1px solid var(--bd);border-radius:16px;padding:1.5rem 2rem;display:flex;align-items:center;justify-content:space-around;gap:1rem;flex-wrap:wrap;}
.ti{display:flex;align-items:center;gap:.8rem;}
.ti-ic{font-size:1.8rem;}
.ti-ttl{font-size:.88rem;font-weight:700;}
.ti-sub{font-size:.78rem;color:var(--gr);}
.tdv{width:1px;height:40px;background:var(--bd);}
.cgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;}
.ccard{border-radius:14px;overflow:hidden;position:relative;cursor:pointer;aspect-ratio:16/9;display:flex;align-items:flex-end;transition:transform .2s;}
.ccard:hover{transform:translateY(-3px);}
.cbg{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:3.5rem;}
.cov{position:absolute;inset:0;background:linear-gradient(to top,rgba(13,16,53,.85),transparent);}
.clbl{position:relative;z-index:1;padding:1rem;color:#fff;font-weight:700;font-size:.9rem;width:100%;}
.ccount{font-size:.75rem;color:rgba(255,255,255,.6);font-weight:400;}
.pgrid{display:grid;grid-template-columns:repeat(4,1fr);gap:1.2rem;}
.pc{background:#fff;border-radius:14px;overflow:hidden;border:1px solid var(--bd);transition:all .25s;cursor:pointer;display:flex;flex-direction:column;}
.pc:hover{box-shadow:0 12px 40px rgba(109,40,217,.12);transform:translateY(-4px);border-color:rgba(109,40,217,.2);}
.pth{aspect-ratio:16/9;background:linear-gradient(135deg,#f0ebff,#e0f2fe);display:flex;align-items:center;justify-content:center;font-size:5rem;position:relative;overflow:hidden;}
html.dark .pth{background:linear-gradient(135deg,#1e2440,#172040);}
.pbdg{position:absolute;top:10px;right:10px;padding:.25rem .65rem;border-radius:7px;font-size:.72rem;font-weight:700;}
.bnn{background:linear-gradient(135deg,var(--p),var(--s));color:#fff;}
.bns{background:#fee2e2;color:var(--re);}
.bnh{background:#fef3c7;color:#92400e;}
.wbtn{position:absolute;top:10px;left:10px;background:#fff;border:none;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.12);font-size:.95rem;transition:all .2s;}
.wbtn:hover{transform:scale(1.1);}
.dcbdg{position:absolute;bottom:10px;right:10px;background:rgba(13,16,53,.82);color:var(--ac);font-size:.68rem;font-weight:700;padding:.2rem .55rem;border-radius:6px;display:flex;align-items:center;gap:.25rem;}
.pb{padding:1rem;flex:1;display:flex;flex-direction:column;gap:.35rem;}
.pnm{font-size:.92rem;font-weight:800;line-height:1.4;color:var(--nv);}
html.dark .pnm{color:var(--tx);}
.prt{display:flex;align-items:center;gap:.3rem;}
.sts{color:var(--st);font-size:.82rem;letter-spacing:.05em;}
.rc{font-size:.75rem;color:var(--gr);}
.ppr{display:flex;align-items:center;justify-content:space-between;margin-top:auto;padding-top:.4rem;border-top:1px solid var(--bd);}
html.dark .ppr{border-color:var(--bd);}
.pp{font-size:1.05rem;font-weight:900;color:var(--p);}
.po{font-size:.75rem;color:var(--gr);text-decoration:line-through;}
.abtn{background:linear-gradient(135deg,var(--p),var(--s));color:#fff;border:none;width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.1rem;flex-shrink:0;transition:all .2s;}
.abtn:hover{transform:scale(1.1);box-shadow:0 4px 12px rgba(109,40,217,.35);}
.promo{border-radius:16px;padding:2.5rem 3rem;display:flex;align-items:center;justify-content:space-between;overflow:hidden;position:relative;}
.promo-c{position:relative;z-index:1;}
.promo-tag{display:inline-block;background:rgba(255,255,255,.15);color:#fff;font-size:.78rem;padding:.25rem .7rem;border-radius:50px;margin-bottom:.6rem;}
.promo-ttl{font-size:1.6rem;font-weight:900;color:#fff;margin-bottom:.3rem;}
.promo-d{color:rgba(255,255,255,.7);font-size:.9rem;}
.promo-btn{background:#fff;border:none;padding:.8rem 2rem;border-radius:10px;font-family:'Cairo',sans-serif;font-size:.95rem;font-weight:800;cursor:pointer;transition:all .2s;position:relative;z-index:1;}
.promo-btn:hover{transform:scale(1.03);}
.rg{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;}
.rc2{background:#fff;border:1px solid var(--bd);border-radius:14px;padding:1.2rem;}
.rh{display:flex;align-items:center;gap:.7rem;margin-bottom:.8rem;}
.rav{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:1rem;flex-shrink:0;}
.rnm{font-weight:700;font-size:.9rem;}
.rdt{font-size:.75rem;color:var(--gr);}
.rst{color:var(--st);font-size:.9rem;margin-bottom:.5rem;}
.rtx{font-size:.85rem;color:var(--tx2);line-height:1.6;}
.rprd{font-size:.78rem;color:var(--p);margin-top:.5rem;font-weight:600;}
.ft-top{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:2rem;padding:3rem 2rem;max-width:1280px;margin:0 auto;}
.fbl{display:flex;align-items:center;gap:.7rem;margin-bottom:1rem;}
.fbi{width:38px;height:38px;border-radius:9px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.2rem;font-weight:900;overflow:hidden;flex-shrink:0;}
.fbi img{width:100%;height:100%;object-fit:cover;}
.fbn{font-size:1.2rem;font-weight:900;color:#fff;}
.fbd{font-size:.85rem;color:rgba(255,255,255,.5);line-height:1.7;margin-bottom:1rem;}
.socs{display:flex;gap:.6rem;flex-wrap:wrap;}
.soc{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:.95rem;color:#fff;text-decoration:none;transition:all .2s;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.07);}
.soc:hover{background:rgba(109,40,217,.45);border-color:var(--p);}
.fct{font-size:.95rem;font-weight:700;color:#fff;margin-bottom:1rem;}
.fls{list-style:none;display:flex;flex-direction:column;gap:.5rem;}
.fls a{color:rgba(255,255,255,.5);text-decoration:none;font-size:.85rem;transition:color .2s;}
.fls a:hover{color:var(--ac);}
.ft-bot{border-top:1px solid rgba(255,255,255,.07);padding:1.2rem 2rem;max-width:1280px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:.5rem;}
.ftcp{font-size:.8rem;color:rgba(255,255,255,.4);}
.paybdgs{display:flex;gap:.5rem;flex-wrap:wrap;}
.paybdg{background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.08);border-radius:6px;padding:.25rem .6rem;font-size:.75rem;color:rgba(255,255,255,.4);}
#mobileNav{display:none;position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid var(--bd);z-index:300;padding:.4rem 0 calc(.6rem + env(safe-area-inset-bottom));}
.mn-items{display:flex;justify-content:space-around;}
.mn-item{display:flex;flex-direction:column;align-items:center;gap:.15rem;cursor:pointer;padding:.3rem .5rem;border:none;background:none;color:var(--gr);font-family:'Cairo',sans-serif;font-size:.65rem;font-weight:600;transition:color .2s;flex:1;}
.mn-item:hover,.mn-item.act{color:var(--p);}
.mn-ic{font-size:1.25rem;}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.52);z-index:400;display:flex;align-items:flex-end;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s;}
.overlay.open{opacity:1;pointer-events:all;}
.sheet{background:#fff;border-radius:20px 20px 0 0;width:100%;max-width:540px;max-height:90vh;overflow-y:auto;transform:translateY(100%);transition:transform .35s cubic-bezier(.34,1.56,.64,1);}
.overlay.open .sheet{transform:translateY(0);}
.sh-handle{width:36px;height:4px;background:#e2e8f0;border-radius:4px;margin:.8rem auto;}
.sh-hd{display:flex;align-items:center;justify-content:space-between;padding:.5rem 1.5rem 1rem;}
.sh-ttl{font-size:1.1rem;font-weight:800;color:var(--nv);}
.sh-cls{background:none;border:none;cursor:pointer;color:var(--gr);font-size:1.3rem;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:8px;}
.sh-cls:hover{background:#f1f5f9;}
.sh-body{padding:0 1.5rem 2rem;}
.ce{text-align:center;padding:2.5rem 0;color:var(--gr);}
.ci{display:flex;align-items:center;gap:.8rem;padding:.8rem 0;border-bottom:1px solid var(--bd);}
.ci-img{width:55px;height:55px;background:linear-gradient(135deg,#f0ebff,#e0f2fe);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.6rem;flex-shrink:0;}
.ci-info{flex:1;}
.ci-nm{font-size:.88rem;font-weight:700;margin-bottom:.15rem;}
.ci-pr{font-size:.9rem;font-weight:800;color:var(--p);}
.ci-qty{display:flex;align-items:center;gap:.5rem;margin-top:.3rem;}
.ci-qty button{background:var(--bd);border:none;width:22px;height:22px;border-radius:50%;cursor:pointer;font-size:.85rem;display:flex;align-items:center;justify-content:center;font-weight:700;}
.ci-qty span{font-size:.85rem;font-weight:700;min-width:16px;text-align:center;}
.ci-rm{background:none;border:none;color:var(--gr);cursor:pointer;font-size:1rem;}
.ci-rm:hover{color:var(--re);}
.csum{background:var(--bg);border-radius:12px;padding:1rem;margin-top:1rem;}
.crow{display:flex;justify-content:space-between;font-size:.88rem;color:var(--tx2);margin-bottom:.4rem;}
.crow.tot{color:var(--nv);font-weight:800;font-size:1rem;border-top:1px dashed var(--bd);margin-top:.5rem;padding-top:.5rem;}
.btn-co{width:100%;background:linear-gradient(135deg,var(--p),var(--s));color:#fff;border:none;padding:.9rem;border-radius:12px;font-family:'Cairo',sans-serif;font-size:1rem;font-weight:800;cursor:pointer;margin-top:1rem;}
.fg{margin-bottom:1rem;}
.fl{display:block;font-size:.82rem;color:var(--gr);margin-bottom:.4rem;font-weight:600;}
.fi{width:100%;border:1.5px solid var(--bd);border-radius:10px;padding:.7rem 1rem;font-family:'Cairo',sans-serif;font-size:.92rem;outline:none;background:#fafafe;color:var(--tx);transition:border-color .2s;}
.fi:focus{border-color:var(--p);}
.otp-row{display:flex;gap:.5rem;justify-content:center;margin:1rem 0;}
.otp-box{width:44px;height:50px;border:2px solid var(--bd);border-radius:12px;text-align:center;font-size:1.3rem;font-weight:800;font-family:'Cairo',sans-serif;outline:none;background:#fafafe;transition:border-color .2s;}
.otp-box:focus{border-color:var(--p);}
.btn-pri{width:100%;background:linear-gradient(135deg,var(--p),var(--s));color:#fff;border:none;padding:.85rem;border-radius:11px;font-family:'Cairo',sans-serif;font-size:.95rem;font-weight:800;cursor:pointer;margin-top:.3rem;}
.btn-pri:disabled{opacity:.55;cursor:not-allowed;}
.hint{text-align:center;font-size:.82rem;color:var(--gr);margin-top:.8rem;}
.hint span{color:var(--p);cursor:pointer;font-weight:700;}
.pd-img{width:100%;aspect-ratio:4/3;background:linear-gradient(135deg,#f0ebff,#e0f2fe);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:7rem;margin-bottom:1.2rem;}
.pay-opts{display:flex;flex-direction:column;gap:.6rem;margin:.7rem 0 1rem;}
.pay-opt{display:flex;align-items:center;gap:.8rem;border:1.5px solid var(--bd);border-radius:11px;padding:.8rem 1rem;cursor:pointer;font-size:.9rem;font-weight:600;}
.pay-opt.sel{border-color:var(--p);background:rgba(109,40,217,.04);}
.qty-ctrl{display:flex;align-items:center;gap:.8rem;background:#f1f5f9;border-radius:10px;padding:.4rem .8rem;width:fit-content;}
.qty-btn{background:#fff;border:1px solid var(--bd);width:30px;height:30px;border-radius:7px;cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;font-weight:700;}
.qty-val{font-size:.95rem;font-weight:700;min-width:24px;text-align:center;}
.dlv-ov{position:fixed;inset:0;background:rgba(8,10,35,.93);backdrop-filter:blur(14px);z-index:900;display:flex;align-items:center;justify-content:center;padding:1rem;opacity:0;pointer-events:none;transition:opacity .4s;}
.dlv-ov.open{opacity:1;pointer-events:all;}
.dlv-card{background:#141847;border:1px solid rgba(167,139,250,.22);border-radius:24px;width:100%;max-width:480px;max-height:90vh;overflow-y:auto;transform:scale(.93);transition:transform .4s cubic-bezier(.34,1.56,.64,1);}
.dlv-ov.open .dlv-card{transform:scale(1);}
.dlv-hd{padding:2rem;text-align:center;}
.dlv-ic{font-size:3.5rem;margin-bottom:.5rem;}
.dlv-ttl{font-size:1.2rem;font-weight:900;color:#fff;}
.dlv-sub{color:rgba(255,255,255,.6);font-size:.85rem;margin-top:.3rem;}
.dlv-body{padding:1.2rem 1.5rem 1.5rem;}
.dlv-info{display:flex;justify-content:space-between;background:rgba(255,255,255,.04);border-radius:10px;padding:.8rem 1rem;margin-bottom:1.2rem;flex-wrap:wrap;gap:.5rem;}
.di-l{font-size:.7rem;color:rgba(255,255,255,.4);}
.di-v{font-size:.88rem;font-weight:700;color:#fff;}
.code-box{background:rgba(255,255,255,.06);border:1px solid rgba(167,139,250,.25);border-radius:14px;padding:1.2rem 1.5rem;text-align:center;margin-bottom:.6rem;}
.code-lbl{font-size:.7rem;color:rgba(255,255,255,.4);margin-bottom:.4rem;}
.code-val{font-size:1.6rem;font-weight:900;letter-spacing:.12em;color:var(--ac);font-family:monospace;}
.acc-box{background:rgba(255,255,255,.05);border:1px solid rgba(167,139,250,.22);border-radius:14px;padding:1rem 1.2rem;margin-bottom:.6rem;}
.acc-row{display:flex;align-items:center;justify-content:space-between;padding:.4rem 0;border-bottom:1px solid rgba(255,255,255,.06);}
.acc-row:last-child{border-bottom:none;}
.acc-l{font-size:.72rem;color:rgba(255,255,255,.4);}
.acc-v{font-size:.88rem;font-weight:700;color:#fff;font-family:monospace;word-break:break-all;}
.btn-cp{background:rgba(167,139,250,.14);border:1px solid rgba(167,139,250,.25);color:var(--ac);padding:.42rem 1rem;border-radius:8px;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.82rem;font-weight:700;display:inline-flex;align-items:center;gap:.3rem;transition:all .2s;}
.btn-cp:hover{background:rgba(167,139,250,.25);}
.wa-row{display:flex;gap:.6rem;flex-wrap:wrap;margin-top:.9rem;padding-top:.9rem;border-top:1px solid rgba(255,255,255,.08);}
.btn-wa-c{flex:1;background:rgba(37,211,102,.1);border:1px solid rgba(37,211,102,.25);color:#25d366;padding:.6rem .7rem;border-radius:9px;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.82rem;font-weight:700;display:flex;align-items:center;justify-content:center;gap:.4rem;}
.btn-wa-o{flex:1;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);color:rgba(255,255,255,.6);padding:.6rem .7rem;border-radius:9px;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.82rem;font-weight:700;display:flex;align-items:center;justify-content:center;gap:.4rem;}
.dlv-note{background:rgba(245,158,11,.06);border:1px solid rgba(245,158,11,.18);border-radius:10px;padding:.7rem 1rem;color:rgba(255,255,255,.6);font-size:.78rem;line-height:1.6;margin-top:1rem;}
.dlv-acts{display:flex;gap:.7rem;margin-top:1rem;}
.dlv-p{flex:1;background:linear-gradient(135deg,var(--p),var(--s));color:#fff;border:none;padding:.8rem;border-radius:11px;font-family:'Cairo',sans-serif;font-size:.9rem;font-weight:800;cursor:pointer;}
.dlv-s{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);color:rgba(255,255,255,.6);padding:.8rem 1.2rem;border-radius:11px;font-family:'Cairo',sans-serif;font-size:.9rem;font-weight:600;cursor:pointer;}
.toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--nv);color:#fff;padding:.7rem 1.4rem;border-radius:50px;font-size:.88rem;font-weight:600;z-index:9999;opacity:0;transition:all .3s;white-space:nowrap;box-shadow:0 4px 20px rgba(0,0,0,.25);pointer-events:none;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
@media(min-width:769px){.toast{bottom:1.5rem;}}
.spin{display:inline-block;animation:spin .8s linear infinite;}
@keyframes spin{to{transform:rotate(360deg)}}
@media(max-width:1100px){.pgrid{grid-template-columns:repeat(3,1fr);}.cgrid{grid-template-columns:repeat(2,1fr);}}
@media(max-width:768px){
  .pgrid{grid-template-columns:repeat(2,1fr);gap:.8rem;}
  .hero{padding:2rem 1.5rem;min-height:260px;}.htitle{font-size:1.6rem;}.hdeco{display:none;}
  .htop{padding:0 1rem;}.hsearch{display:none;}
  .hnav ul{padding:0 .5rem;overflow-x:auto;}
  .hnav a{padding:.6rem .7rem;font-size:.8rem;}
  .cgrid{grid-template-columns:repeat(2,1fr);}
  .cnt{padding:0 1rem;}
  #mobileNav{display:block;}
  .ft-top{grid-template-columns:1fr 1fr;}
  .ft-top>div:first-child{grid-column:1/-1;}
  .rg{grid-template-columns:1fr;}
  .trust{justify-content:flex-start;}.tdv{display:none;}
  .promo{flex-direction:column;gap:1rem;}
  body{padding-bottom:65px;}
}
@media(max-width:480px){.ft-top{grid-template-columns:1fr;}}
/* â”€â”€ MOBILE IMPROVEMENTS â”€â”€ */
@media(max-width:480px){
  .htop{padding:0 .7rem;gap:.5rem;}
  .hbtn{padding:.4rem .6rem;font-size:.78rem;}
  .hbtn.primary{padding:.4rem .75rem;}
  .logo-name{font-size:1.1rem;}
  .pgrid{grid-template-columns:repeat(2,1fr);gap:.6rem;}
  .hero{padding:1.8rem 1rem;min-height:220px;}
  .htitle{font-size:1.35rem;}
  .hstats{gap:1rem;}
  .hsn{font-size:1.1rem;}
  .cnt{padding:0 .75rem;}
  .trust{padding:1rem;}
  .promo{padding:1.5rem 1.2rem;}
  .promo-ttl{font-size:1.2rem;}
}
/* â”€â”€ DARK MODE â”€â”€ */
html.dark{
  --tx:#e2e8f0;--tx2:#cbd5e1;--gr:#94a3b8;--bd:#2e3656;
  --bg:#0e1127;--nv:#0a0d20;--nv2:#141730;
  --ac:#c4b5fd;
}
html.dark body{background:var(--bg);}
html.dark header{background:#131729;border-color:var(--bd);}
html.dark .hnav{border-color:var(--bd);}
html.dark .logo-name{color:#e2e8f0;}
html.dark .hsearch input{background:#1e2440;border-color:var(--bd);color:var(--tx);}
html.dark .hbtn{background:#1e2440;border-color:var(--bd);color:var(--tx);}
html.dark .pc,.html.dark .rc2{background:#131729;border-color:var(--bd);}
html.dark .pc{background:#131729;border-color:var(--bd);}
html.dark .pth{background:linear-gradient(135deg,#1e2440,#172040);}
html.dark .rc2{background:#131729;border-color:var(--bd);}
html.dark .trust{background:#131729;border-color:var(--bd);}
html.dark .sheet{background:#131729;}
html.dark .sh-cls:hover{background:#1e2440;}
html.dark .fi{background:#1e2440;border-color:var(--bd);color:var(--tx);}
html.dark .ci{border-color:var(--bd);}
html.dark .ci-img{background:#1e2440;}
html.dark .csum{background:#0e1127;}
html.dark .qty-ctrl{background:#1e2440;}
html.dark .qty-btn{background:#131729;border-color:var(--bd);color:var(--tx);}
html.dark .pay-opt{border-color:var(--bd);color:var(--tx);}
html.dark .dlv-card{background:#0e1127;}
html.dark .pnm,.html.dark .ci-nm{color:var(--tx);}
html.dark .pnm{color:var(--tx);}
html.dark .ci-nm{color:var(--tx);}
html.dark .otp-box{background:#1e2440;border-color:var(--bd);color:var(--tx);}
html.dark #mobileNav{background:#131729;border-color:var(--bd);}
html.dark .mn-item{color:var(--gr);}
html.dark .sh-ttl{color:var(--tx);}
html.dark .see-all{color:var(--p);}
html.dark .sec-ttl{color:var(--tx);}
html.dark .timer-badge{background:#1e2440;}
/* â”€â”€ PRODUCT FULL PAGE â”€â”€ */
#prodFullPage{position:fixed;inset:0;background:var(--bg);z-index:600;overflow-y:auto;display:none;animation:slideIn .3s ease;}
#prodFullPage.open{display:block;}
@keyframes slideIn{from{transform:translateX(30px);opacity:0}to{transform:translateX(0);opacity:1}}
.pfp-header{background:#fff;border-bottom:1px solid var(--bd);padding:.8rem 1.5rem;display:flex;align-items:center;gap:.8rem;position:sticky;top:0;z-index:10;}
html.dark .pfp-header{background:#131729;border-color:var(--bd);}
.pfp-back{background:none;border:1px solid var(--bd);border-radius:9px;padding:.45rem .9rem;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.85rem;color:var(--tx);display:flex;align-items:center;gap:.3rem;transition:all .2s;}
.pfp-back:hover{border-color:var(--p);color:var(--p);}
.pfp-title{font-size:1rem;font-weight:800;color:var(--nv);}
html.dark .pfp-title{color:var(--tx);}
.pfp-body{max-width:800px;margin:0 auto;padding:1.5rem;}
.pfp-img{width:100%;aspect-ratio:16/9;background:linear-gradient(135deg,#f0ebff,#e0f2fe);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:9rem;margin-bottom:1.5rem;}
html.dark .pfp-img{background:linear-gradient(135deg,#1e2440,#172040);}
.pfp-meta{display:grid;grid-template-columns:1fr auto;gap:1rem;align-items:start;margin-bottom:1.2rem;}
.pfp-price-big{font-size:2rem;font-weight:900;color:var(--p);}
.pfp-old{font-size:.9rem;color:var(--gr);text-decoration:line-through;margin-right:.5rem;}
.pfp-disc{background:#fee2e2;color:var(--re);font-size:.75rem;font-weight:700;padding:.2rem .5rem;border-radius:6px;}
.pfp-actions{display:flex;align-items:center;gap:.8rem;background:#f8f7ff;border-radius:14px;padding:1rem;margin-bottom:1.5rem;}
html.dark .pfp-actions{background:#1e2440;}
.pfp-add-btn{flex:1;background:linear-gradient(135deg,var(--p),var(--s));color:#fff;border:none;padding:.85rem;border-radius:12px;font-family:'Cairo',sans-serif;font-size:1rem;font-weight:800;cursor:pointer;transition:all .2s;}
.pfp-add-btn:hover{opacity:.9;transform:translateY(-1px);}
.pfp-divider{border:none;border-top:1px solid var(--bd);margin:1.5rem 0;}
/* â”€â”€ CATEGORY PAGE â”€â”€ */
#catPage{position:fixed;inset:0;background:var(--bg);z-index:600;overflow-y:auto;display:none;animation:slideIn .3s ease;}
#catPage.open{display:block;}
.cp-header{background:linear-gradient(135deg,var(--nv),var(--nv2));padding:1.5rem;display:flex;align-items:center;gap:1rem;}
.cp-back{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);border-radius:9px;padding:.45rem .9rem;cursor:pointer;font-family:'Cairo',sans-serif;font-size:.85rem;color:#fff;display:flex;align-items:center;gap:.3rem;}
.cp-back:hover{background:rgba(255,255,255,.18);}
.cp-info h2{font-size:1.4rem;font-weight:900;color:#fff;}
.cp-info p{font-size:.85rem;color:rgba(255,255,255,.6);}
.cp-body{max-width:1280px;margin:0 auto;padding:1.5rem;}
/* â”€â”€ REVIEW SECTION â”€â”€ */
.rev-section{margin-top:1.5rem;}
.rev-hd{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;}
.rev-ttl{font-size:1rem;font-weight:800;color:var(--nv);}
html.dark .rev-ttl{color:var(--tx);}
.rev-stars-inp{display:flex;gap:.3rem;margin:.5rem 0;}
.rev-star{font-size:1.5rem;cursor:pointer;opacity:.3;transition:opacity .2s;}
.rev-star.sel{opacity:1;}
.rev-card{background:#fff;border:1px solid var(--bd);border-radius:12px;padding:1rem;margin-bottom:.8rem;}
html.dark .rev-card{background:#131729;border-color:var(--bd);}
.rev-author{font-weight:700;font-size:.88rem;margin-bottom:.2rem;}
.rev-date{font-size:.75rem;color:var(--gr);}
.rev-text{font-size:.85rem;color:var(--tx2);margin-top:.4rem;line-height:1.6;}
.rev-form{background:#f8f7ff;border-radius:14px;padding:1.2rem;margin-top:1rem;}
html.dark .rev-form{background:#1e2440;}
html.dark .rnm{color:var(--tx);}
html.dark .rtx{color:var(--tx2);}
html.dark .pfp-back{background:#1e2440;border-color:var(--bd);color:var(--tx);}
html.dark .pfp-title{color:var(--tx);}
html.dark #prodFullPage{background:var(--bg);}
html.dark #catPage{background:var(--bg);}
html.dark .ci-nm{color:var(--tx);}
html.dark .csum .crow{color:var(--tx2);}
html.dark .csum .crow.tot{color:var(--tx);}
html.dark .pay-opt{color:var(--tx);background:#1e2440;}
html.dark .pay-opt.sel{background:rgba(109,40,217,.15);}
html.dark .rev-card{background:#131729;border-color:var(--bd);}
html.dark .rev-author{color:var(--tx);}
html.dark .rev-text{color:var(--tx2);}
html.dark .pfp-divider{border-color:var(--bd);}
html.dark #ls-tabs{background:#1e2440 !important;}
html.dark #ls-tabs button:not([style*="linear-gradient"]){color:var(--tx2);}
html.dark .hnav a{color:var(--tx2);}
html.dark .hnav a:hover,html.dark .hnav a.act{color:var(--p);}
html.dark #darkBtn{background:#131729;border-color:var(--bd);}
html.dark .pfp-actions>div{background:#1e2440;border-color:var(--bd);}
html.dark .pfp-actions>div button{color:var(--p);}
html.dark .pfp-actions>div span{color:var(--tx);}
html.dark h2,html.dark .pfp-meta h2{color:var(--tx);}
html.dark .pfp-price-big{color:var(--p);}
html.dark .pfp-body p{color:var(--tx2);}
html.dark .myOrdersSheet .sh-body>div>div{background:#131729 !important;border-color:var(--bd) !important;}
html.dark .sh-body .fl{color:var(--tx2);}
html.dark .see-all{border-color:rgba(167,139,250,.3);}

</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     ğŸ”¥  FIREBASE CONFIG  â€” Ø¶Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§
     Ø§ÙØªØ­ Firebase Console â†’ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ â†’ ØªØ·Ø¨ÙŠÙ‚Ø§ØªÙƒ
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
const FIREBASE_CONFIG = {
  apiKey:            "AIzaSyAMpqsqJtZ5OIDDPyn64VUUZssEkaVzy5s",
  authDomain:        "my-store-6a072.firebaseapp.com",
  projectId:         "my-store-6a072",
  storageBucket:     "my-store-6a072.firebasestorage.app",
  messagingSenderId: "637762823797",
  appId:             "1:637762823797:web:e01355f7d37c5080f07a3c"
};
</script>

<!-- Firebase Firestore only (no Auth needed) -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<!-- EmailJS SDK -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  âš™ï¸ EmailJS CONFIG â€” Ø¶Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§
//  Ø³Ø¬Ù‘Ù„ ÙÙŠ emailjs.com â† My Account â† API Keys
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const EMAILJS_CONFIG = {
  publicKey:   'pHWuJi7jJfbEkGsrh',    // Ù…Ù† ØµÙØ­Ø© Account â†’ API Keys
  serviceId:   'service_4f3qbkm',    // Ù…Ù† Email Services
  templateId:  'template_16afteh',   // Ù…Ù† Email Templates
};
emailjs.init(EMAILJS_CONFIG.publicKey);
</script>


<div id="announceBar"><div class="atrack" id="atrack"></div></div>

<header>
  <div class="htop">
    <div class="logo" id="storeLogo" onclick="scrollTo({top:0,behavior:'smooth'})"></div>
    <div class="hsearch"><button class="hsi">ğŸ”</button><input type="text" id="searchInp" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." oninput="liveSearch()"></div>
    <div class="hactions" id="hactions"></div>
  </div>
  <nav class="hnav"><ul id="navLinks"></ul></nav>
</header>

<main>
  <div class="hero" id="heroSection">
    <div class="hcnt">
      <div class="htag" id="heroTag"></div>
      <h1 class="htitle"><span id="heroL1"></span><br><span class="hl" id="heroL2"></span></h1>
      <p class="hdesc" id="heroDesc"></p>
      <div class="hbtns">
        <button class="hbp" id="hBtn1" onclick="document.getElementById('prodsec').scrollIntoView({behavior:'smooth'})"></button>
        <button class="hbs" id="hBtn2"></button>
      </div>
      <div class="hstats" id="heroStats"></div>
    </div>
    <div class="hdeco" id="heroDeco"></div>
  </div>
  <div class="cnt" style="margin-top:1.5rem;"><div class="trust" id="trustBar"></div></div>
  <div class="cnt sec">
    <div class="sec-hd"><div class="sec-ttl" id="catSecTitle">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚</div></div>
    <div class="cgrid" id="catsGrid"></div>
  </div>
  <div class="cnt sec" id="prodsec">
    <div class="sec-hd">
      <div class="sec-ttl" id="prodsTitle">Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹</div>
      <button class="see-all" onclick="openCatPage('all')">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
    </div>
    <div class="pgrid" id="prodsGrid"></div>
  </div>
  <div class="cnt" style="padding-bottom:2.5rem;" id="promoWrap">
    <div class="promo" id="promoBnr">
      <div class="promo-c">
        <div class="promo-tag" id="promoTag"></div>
        <div class="promo-ttl" id="promoTitle"></div>
        <div class="promo-d" id="promoDesc"></div>
      </div>
      <button class="promo-btn" id="promoBtn"></button>
    </div>
  </div>
  <div class="cnt sec">
    <div class="sec-hd"><div class="sec-ttl" id="featTitle">Ø£Ø¨Ø±Ø² Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div></div>
    <div class="pgrid" id="featGrid"></div>
  </div>
  <div class="cnt sec">
    <div class="sec-hd"><div class="sec-ttl">Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div></div>
    <div class="rg" id="reviewsGrid"></div>
  </div>
</main>

<footer id="siteFooter">
  <div class="ft-top" id="footerTop"></div>
  <div class="ft-bot" id="footerBot"></div>
</footer>

<div id="mobileNav"><div class="mn-items" id="mnItems"></div></div>
<!-- â•â•â•â• PRODUCT FULL PAGE â•â•â•â• -->
<div id="prodFullPage">
  <div class="pfp-header">
    <button class="pfp-back" onclick="closeProdPage()">â† Ø±Ø¬ÙˆØ¹</button>
    <div class="pfp-title" id="pfpTitle">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</div>
  </div>
  <div class="pfp-body" id="pfpBody"></div>
</div>

<!-- â•â•â•â• CATEGORY PAGE â•â•â•â• -->
<div id="catPage">
  <div class="cp-header">
    <button class="cp-back" onclick="closeCatPage()">â† Ø±Ø¬ÙˆØ¹</button>
    <div class="cp-info">
      <h2 id="cpName"></h2>
      <p id="cpCount"></p>
    </div>
  </div>
  <div class="cp-body">
    <div class="pgrid" id="cpGrid"></div>
  </div>
</div>

<!-- â•â•â•â• DARK MODE TOGGLE â•â•â•â• -->
<button id="darkBtn" onclick="toggleDark()" style="position:fixed;bottom:80px;left:1rem;z-index:350;background:#fff;border:1px solid var(--bd);border-radius:50%;width:44px;height:44px;font-size:1.2rem;cursor:pointer;box-shadow:0 4px 14px rgba(0,0,0,.15);transition:all .2s;" title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†">ğŸŒ™</button>

<div class="toast" id="toast"></div>

<!-- CODE DELIVERY OVERLAY -->
<div class="dlv-ov" id="dlvOv">
  <div class="dlv-card">
    <div class="dlv-hd" id="dlvHead"></div>
    <div class="dlv-body">
      <div class="dlv-info" id="dlvInfo"></div>
      <div id="dlvCodes"></div>
      <div class="dlv-note">âš ï¸ Ø§Ø­ØªÙØ¸ Ø¨Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ù…ÙƒØ§Ù† Ø¢Ù…Ù†. ÙƒÙ„ ÙƒÙˆØ¯ ÙŠÙØ³ØªØ®Ø¯Ù… Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· ÙˆÙ„Ù† ÙŠÙØ¹Ø±Ø¶ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø§ÙØ°Ø©.</div>
      <div class="dlv-acts">
        <button class="dlv-p" onclick="closeDlv()">âœ“ ÙÙ‡Ù…ØªØŒ Ø´ÙƒØ±Ø§Ù‹!</button>
        <button class="dlv-s" onclick="showToast('ğŸ“¸ Ø§Ù„ØªÙ‚Ø· ØµÙˆØ±Ø© Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø¢Ù† Ù„Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨ÙƒÙˆØ¯Ùƒ')">ğŸ“¸ Ø­ÙØ¸ ØµÙˆØ±Ø©</button>
      </div>
    </div>
  </div>
</div>

<!-- â•â• LOGIN / REGISTER SHEET â•â• -->
<div class="overlay" id="loginSheet" onclick="bgClose(event,'loginSheet')">
  <div class="sheet"><div class="sh-handle"></div>
    <div class="sh-hd">
      <div class="sh-ttl" id="loginSheetTitle">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
      <button class="sh-cls" onclick="closeSheet('loginSheet')">âœ•</button>
    </div>
    <div class="sh-body">

      <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
      <div id="ls-tabs" style="display:flex;background:#f1f0fa;border-radius:12px;padding:.25rem;margin-bottom:1.3rem;gap:.25rem;">
        <button id="tab-login" onclick="switchAuthTab('login')" style="flex:1;padding:.6rem;border:none;border-radius:9px;font-family:Cairo,sans-serif;font-size:.88rem;font-weight:700;cursor:pointer;background:linear-gradient(135deg,var(--p),var(--s));color:#fff;transition:all .2s;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ğŸ”‘</button>
        <button id="tab-register" onclick="switchAuthTab('register')" style="flex:1;padding:.6rem;border:none;border-radius:9px;font-family:Cairo,sans-serif;font-size:.88rem;font-weight:700;cursor:pointer;background:transparent;color:var(--gr);transition:all .2s;">Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ âœ¨</button>
      </div>

      <!-- STEP 1 â€” Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ -->
      <div id="ls1">
        <div id="ls1-welcome" style="display:none;background:linear-gradient(135deg,rgba(109,40,217,.08),rgba(37,99,235,.05));border:1px solid rgba(109,40,217,.15);border-radius:10px;padding:.7rem 1rem;margin-bottom:.9rem;font-size:.88rem;font-weight:700;color:var(--p);"></div>

        <div class="fg" id="ls1-name-row" style="display:none;">
          <label class="fl">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
          <input type="text" class="fi" id="regName" placeholder="Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø£Ø­Ù…Ø¯ÙŠ (Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ)">
        </div>

        <div class="fg">
          <label class="fl">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
          <input type="email" class="fi" id="emailF" placeholder="Ø¨Ø±ÙŠØ¯Ùƒ@gmail.com" autocomplete="email" onkeydown="if(event.key==='Enter')doSendOTP()">
        </div>

        <button class="btn-pri" id="sendOtpBtn" onclick="doSendOTP()">Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ğŸ“§</button>
        <p style="text-align:center;font-size:.72rem;color:var(--gr);margin-top:.8rem;">ğŸ”’ Ø³ÙŠØµÙ„Ùƒ Ø±Ù…Ø² Ù…ÙƒÙˆÙ‘Ù† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ</p>
      </div>

      <!-- STEP 2 â€” Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² OTP -->
      <div id="ls2" style="display:none;">
        <p style="text-align:center;color:var(--gr);font-size:.88rem;margin-bottom:.3rem;">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…Ø±Ø³Ù„ Ø¥Ù„Ù‰</p>
        <p style="text-align:center;font-size:.95rem;font-weight:800;color:var(--p);margin-bottom:1.2rem;word-break:break-all;" id="ls2-email"></p>

        <!-- ØµÙ†Ø§Ø¯ÙŠÙ‚ OTP -->
        <div class="otp-row">
          <input type="text" class="otp-box" maxlength="1" inputmode="numeric" oninput="otpN(this,0)" onkeydown="otpBack(event,this,0)">
          <input type="text" class="otp-box" maxlength="1" inputmode="numeric" oninput="otpN(this,1)" onkeydown="otpBack(event,this,1)">
          <input type="text" class="otp-box" maxlength="1" inputmode="numeric" oninput="otpN(this,2)" onkeydown="otpBack(event,this,2)">
          <input type="text" class="otp-box" maxlength="1" inputmode="numeric" oninput="otpN(this,3)" onkeydown="otpBack(event,this,3)">
          <input type="text" class="otp-box" maxlength="1" inputmode="numeric" oninput="otpN(this,4)" onkeydown="otpBack(event,this,4)">
          <input type="text" class="otp-box" maxlength="1" inputmode="numeric" oninput="otpN(this,5)" onkeydown="otpBack(event,this,5)">
        </div>

        <!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© -->
        <p style="text-align:center;font-size:.8rem;color:var(--gr);margin-bottom:.8rem;">
          Ø§Ù„Ø±Ù…Ø² ØµØ§Ù„Ø­ Ù„Ù€ <span id="otpTimer" style="color:var(--p);font-weight:800;">10:00</span>
        </p>

        <button class="btn-pri" id="verifyOtpBtn" onclick="doVerifyOTP()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø² âœ“</button>
        <div class="hint" style="margin-top:.9rem;">
          ØªØºÙŠÙŠØ± Ø§Ù„Ø¨Ø±ÙŠØ¯ØŸ <span onclick="backToEmail()" style="color:var(--p);cursor:pointer;font-weight:700;">Ø±Ø¬ÙˆØ¹</span>
          &nbsp;Â·&nbsp;
          Ù„Ù… ÙŠØµÙ„ÙƒØŸ <span onclick="doSendOTP(true)" style="color:var(--p);cursor:pointer;font-weight:700;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</span>
        </div>
      </div>

      <!-- STEP 3 â€” Ù†Ø¬Ø§Ø­ -->
      <div id="ls3" style="display:none;">
        <div style="text-align:center;padding:1.5rem 0;">
          <div style="width:72px;height:72px;background:linear-gradient(135deg,var(--p),var(--s));border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem;font-size:2rem;color:#fff;">âœ“</div>
          <div style="font-size:1.2rem;font-weight:900;margin-bottom:.3rem;" id="ls3-greeting">Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹!</div>
          <div style="font-size:1rem;font-weight:700;color:var(--p);" id="ls3-name"></div>
          <div style="font-size:.8rem;color:var(--gr);margin-top:.2rem;" id="ls3-phone"></div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- CART SHEET -->
<div class="overlay" id="cartSheet" onclick="bgClose(event,'cartSheet')">
  <div class="sheet"><div class="sh-handle"></div>
    <div class="sh-hd"><div class="sh-ttl">ğŸ›’ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</div><button class="sh-cls" onclick="closeSheet('cartSheet')">âœ•</button></div>
    <div class="sh-body" id="cartBody"></div>
  </div>
</div>

<!-- PRODUCT DETAIL -->
<div class="overlay" id="pdSheet" onclick="bgClose(event,'pdSheet')">
  <div class="sheet" style="max-width:550px;"><div class="sh-handle"></div>
    <div class="sh-hd"><div class="sh-ttl" id="pdTitle"></div><button class="sh-cls" onclick="closeSheet('pdSheet')">âœ•</button></div>
    <div class="sh-body" id="pdBody"></div>
  </div>
</div>

<!-- CHECKOUT -->
<div class="overlay" id="coSheet" onclick="bgClose(event,'coSheet')">
  <div class="sheet"><div class="sh-handle"></div>
    <div class="sh-hd"><div class="sh-ttl">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</div><button class="sh-cls" onclick="closeSheet('coSheet')">âœ•</button></div>
    <div class="sh-body" id="coBody"></div>
  </div>
</div>

<!-- MY ORDERS -->
<div class="overlay" id="myOrdersSheet" onclick="bgClose(event,'myOrdersSheet')">
  <div class="sheet" style="max-width:580px;"><div class="sh-handle"></div>
    <div class="sh-hd">
      <div class="sh-ttl">ğŸ‘¤ Ø­Ø³Ø§Ø¨ÙŠ ÙˆØ·Ù„Ø¨Ø§ØªÙŠ</div>
      <div style="display:flex;gap:.5rem;">
        <button class="sh-cls" style="background:rgba(239,68,68,.08);color:var(--re);font-size:.78rem;width:auto;padding:.3rem .7rem;border-radius:7px;font-family:Cairo,sans-serif;font-weight:700;" onclick="doLogout();closeSheet('myOrdersSheet')">Ø®Ø±ÙˆØ¬ â»</button>
        <button class="sh-cls" onclick="closeSheet('myOrdersSheet')">âœ•</button>
      </div>
    </div>
    <div class="sh-body">
      <div style="background:linear-gradient(135deg,var(--nv),var(--nv2));border-radius:14px;padding:1.2rem;margin-bottom:1.2rem;display:flex;align-items:center;gap:1rem;">
        <div style="width:52px;height:52px;background:linear-gradient(135deg,var(--p),var(--s));border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.4rem;font-weight:900;flex-shrink:0;">ğŸ‘¤</div>
        <div>
          <div style="color:#fff;font-size:1rem;font-weight:800;" id="myOrdersName"></div>
          <div style="color:rgba(255,255,255,.55);font-size:.8rem;" id="myOrdersPhone"></div>
          <div style="color:rgba(255,255,255,.4);font-size:.72rem;margin-top:.2rem;">Ø¹Ø¶Ùˆ Ù…Ù†Ø° <span id="myOrdersJoin"></span></div>
          <div style="color:var(--ac);font-size:.78rem;font-weight:700;" id="myOrdersCount"></div>
        </div>
      </div>
      <div style="font-size:.92rem;font-weight:800;color:var(--nv);margin-bottom:.8rem;">ğŸ›ï¸ Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
      <div id="myOrdersList"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MAIN SCRIPT
     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â”€â”€ Firebase Init â”€â”€
firebase.initializeApp(FIREBASE_CONFIG);
const fbDb = firebase.firestore();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  DEFAULT CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEF = {
  meta:{ name:'Ù…ØªØ¬Ø±ÙŠ', logoLetter:'Ù…', logoText:'Ù…ØªØ¬Ø±ÙŠ', tagline:'ØªØ³ÙˆÙ‚ Ø¨Ø°ÙˆÙ‚', logoImg:'' },
  colors:{ primary:'#7c3aed', secondary:'#2563eb', navy:'#0d1035', navy2:'#141847', accent:'#a78bfa', bg:'#f8f7ff', footerBg:'#0d1035' },
  hero:{ tag:'âœ¨ Ù…Ø¬Ù…ÙˆØ¹Ø© 2025', l1:'ØªØ³ÙˆÙ‘Ù‚ Ø£ÙØ¶Ù„', l2:'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©', desc:'Ø§ÙƒØªØ´Ù ØªØ´ÙƒÙŠÙ„Ø© Ø­ØµØ±ÙŠØ© Ù…Ù† Ø£Ø¬ÙˆØ¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø£Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ© Ù…Ø¹ ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ Ù„Ø¨Ø§Ø¨ Ù…Ù†Ø²Ù„Ùƒ', btn1:'ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†', btn2:'Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ø®Ø§ØµØ©', deco:'ğŸ›ï¸', s1v:'+500', s1l:'Ø¹Ù…ÙŠÙ„ Ø³Ø¹ÙŠØ¯', s2v:'+80', s2l:'Ù…Ù†ØªØ¬', s3v:'24h', s3l:'ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹' },
  announce:{ on:true, speed:28, items:['ğŸ‰ Ø¹Ø±Ø¶ Ù…Ø¤Ù‚Øª: Ø§Ø´ØªØ±Ù Ù…Ù†ØªØ¬ÙŠÙ† ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ','âœ… Ø¯ÙØ¹ Ø¢Ù…Ù† Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©','ğŸš€ ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹ Ù„Ø¬Ù…ÙŠØ¹ Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ù…Ù„ÙƒØ©','ğŸ’œ Ø£ÙƒØ«Ø± Ù…Ù† 500 Ø¹Ù…ÙŠÙ„ Ø±Ø§Ø¶Ù'] },
  trust:[{icon:'ğŸ”’',title:'Ø¯ÙØ¹ Ø¢Ù…Ù†',desc:'ØªØ´ÙÙŠØ± ÙƒØ§Ù…Ù„'},{icon:'âš¡',title:'ØªØ³Ù„ÙŠÙ… ÙÙˆØ±ÙŠ',desc:'Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹ Ù…Ø¨Ø§Ø´Ø±Ø©'},{icon:'ğŸšš',title:'ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹',desc:'24-48 Ø³Ø§Ø¹Ø©'},{icon:'ğŸ§',title:'Ø¯Ø¹Ù… 24/7',desc:'Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ'}],
  cats:[{label:'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',count:'3 Ù…Ù†ØªØ¬Ø§Øª',icon:'ğŸ“±',color:'#312e81,#1e3a8a',key:'electronics'},{label:'Ø£Ø²ÙŠØ§Ø¡',count:'2 Ù…Ù†ØªØ¬Ø§Øª',icon:'ğŸ‘œ',color:'#4c1d95,#5b21b6',key:'fashion'},{label:'Ø¥ÙƒØ³Ø³ÙˆØ§Ø±',count:'2 Ù…Ù†ØªØ¬Ø§Øª',icon:'ğŸ’',color:'#1e40af,#1d4ed8',key:'accessories'},{label:'Ø§Ù„Ù…Ù†Ø²Ù„',count:'1 Ù…Ù†ØªØ¬',icon:'ğŸ¡',color:'#3730a3,#4338ca',key:'home'}],
  promo:{ on:true, tag:'âš¡ Ø¹Ø±Ø¶ Ù…Ø­Ø¯ÙˆØ¯', title:'Ø§Ø´ØªØ±Ù 2 ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ 1 Ù…Ø¬Ø§Ù†Ø§Ù‹', desc:'Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±', btn:'Ø§Ø³ØªÙØ¯ Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶', cat:'accessories', bg:'#0d1035,#7c3aed' },
  social:[{id:'whatsapp',label:'ÙˆØ§ØªØ³Ø§Ø¨',icon:'ğŸ’¬',url:'',on:true},{id:'twitter',label:'ØªÙˆÙŠØªØ± X',icon:'ğ•',url:'',on:true},{id:'instagram',label:'Ø¥Ù†Ø³ØªØºØ±Ø§Ù…',icon:'ğŸ“¸',url:'',on:true},{id:'snapchat',label:'Ø³Ù†Ø§Ø¨',icon:'ğŸ‘»',url:'',on:false},{id:'tiktok',label:'ØªÙŠÙƒ ØªÙˆÙƒ',icon:'ğŸµ',url:'',on:false},{id:'youtube',label:'ÙŠÙˆØªÙŠÙˆØ¨',icon:'â–¶ï¸',url:'',on:false}],
  mobileNav:[{icon:'ğŸ ',label:'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',action:'home'},{icon:'ğŸ›’',label:'Ø§Ù„Ø³Ù„Ø©',action:'cart'},{icon:'ğŸ‘¤',label:'Ø­Ø³Ø§Ø¨ÙŠ',action:'login'},{icon:'ğŸ”¥',label:'Ø§Ù„Ø¹Ø±ÙˆØ¶',action:'offers'}],
  nav:[{label:'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',url:'#',cat:''},{label:'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',url:'#',cat:'electronics'},{label:'Ø£Ø²ÙŠØ§Ø¡',url:'#',cat:'fashion'},{label:'Ø¥ÙƒØ³Ø³ÙˆØ§Ø±',url:'#',cat:'accessories'},{label:'Ø§Ù„Ù…Ù†Ø²Ù„',url:'#',cat:'home'},{label:'ğŸ”¥ Ø¹Ø±ÙˆØ¶',url:'#',cat:'sale',hl:true}],
  footer:{ desc:'Ù…ØªØ¬Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…ØªØ®ØµØµ ÙŠÙ‚Ø¯Ù… Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø£Ø³Ø¹Ø§Ø± ØªÙ†Ø§ÙØ³ÙŠØ©.', c1t:'Ø±ÙˆØ§Ø¨Ø· Ù…Ù‡Ù…Ø©', c1:[{l:'Ù…Ù† Ù†Ø­Ù†',u:'#'},{l:'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§',u:'#'},{l:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©',u:'#'},{l:'Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹',u:'#'}], c2t:'Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª', c2:[{l:'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',u:'#'},{l:'Ø£Ø²ÙŠØ§Ø¡',u:'#'},{l:'Ø¥ÙƒØ³Ø³ÙˆØ§Ø±',u:'#'},{l:'Ø§Ù„Ù…Ù†Ø²Ù„',u:'#'}], c3t:'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§', c3:[{l:'ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨',u:'#'},{l:'ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯',u:'#'},{l:'ğŸ• 9Øµ - 10Ù…',u:'#'}], pay:['Visa','Mada','Apple Pay','STC Pay'], copy:'Â© 2025 Ù…ØªØ¬Ø±ÙŠ â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©' },
  delivery:{ ownerWA:'966500000000', sendCust:true, sendOwner:true, msg:'ğŸ‰ Ø´ÙƒØ±Ø§Ù‹ Ù„Ø·Ù„Ø¨Ùƒ Ù…Ù† {store}!\n\nØ±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: {order}\nØ§Ù„Ù…Ù†ØªØ¬: {product}\n\n{codeBlock}\n\nâš ï¸ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ø®Ø§Øµ Ø¨Ùƒ.' },
  store:{ freeShip:300, shipFee:25, currency:'Ø±.Ø³', cod:true },
  reviews:[{name:'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ',ini:'Ø£',clr:'',date:'Ù…Ù†Ø° 3 Ø£ÙŠØ§Ù…',stars:5,text:'Ù…Ù†ØªØ¬ Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹! Ø§Ù„ÙƒÙˆØ¯ ÙˆØµÙ„Ù†ÙŠ ÙÙˆØ±Ø§Ù‹.',prod:'Ø³Ù…Ø§Ø¹Ø§Øª Ù„Ø§Ø³Ù„ÙƒÙŠØ© Pro'},{name:'Ø³Ø§Ø±Ø© Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ',ini:'Ø³',clr:'#0ea5e9,#2563eb',date:'Ù…Ù†Ø° Ø£Ø³Ø¨ÙˆØ¹',stars:5,text:'ØªØ¬Ø±Ø¨Ø© Ù…Ù…ØªØ§Ø²Ø©!',prod:'Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ© Elite'},{name:'Ù…Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ',ini:'Ù…',clr:'#7c3aed,#9333ea',date:'Ù…Ù†Ø° Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ†',stars:4,text:'Ø®Ø¯Ù…Ø© Ø±Ø§Ø¦Ø¹Ø© ÙˆØªØ³Ù„ÙŠÙ… Ø³Ø±ÙŠØ¹.',prod:'Ø¹Ø·Ø± Noir Luxe'}]
};

function loadCfg(){
  try{const s=localStorage.getItem('storeConfig');if(s){const p=JSON.parse(s);const o=JSON.parse(JSON.stringify(DEF));for(const k in p){if(p[k]!==null&&typeof p[k]==='object'&&!Array.isArray(p[k]))o[k]=Object.assign({},DEF[k]||{},p[k]);else o[k]=p[k];}return o;}}catch(e){}
  return JSON.parse(JSON.stringify(DEF));
}
let C=loadCfg();

(function applyColors(){
  const r=document.documentElement.style,col=C.colors;
  r.setProperty('--p',col.primary);r.setProperty('--s',col.secondary);
  r.setProperty('--nv',col.navy);r.setProperty('--nv2',col.navy2||col.navy);
  r.setProperty('--ac',col.accent);r.setProperty('--bg',col.bg);
})();

// â•â•â•â•â•â•â•â• PRODUCTS â•â•â•â•â•â•â•â•
let products=[];
try{const sp=localStorage.getItem('storeProducts');if(sp)products=JSON.parse(sp);}catch(e){}
if(!products.length)products=[
  {id:1,name:'Ø³Ù…Ø§Ø¹Ø§Øª Ù„Ø§Ø³Ù„ÙƒÙŠØ© Pro',price:249,oldPrice:320,desc:'Ø³Ù…Ø§Ø¹Ø§Øª Ø¨Ù„ÙˆØªÙˆØ« Ø¨Ø¬ÙˆØ¯Ø© ØµÙˆØª Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠØ©.',emoji:'ğŸ§',cat:'electronics',badge:'sale',rating:4.8,rCount:124,featured:true,active:true,codeType:'code',codes:[{val:'AUDIO-X71K',used:false},{val:'AUDIO-M89P',used:false}]},
  {id:2,name:'Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ© Elite',price:599,oldPrice:750,desc:'Ø³Ø§Ø¹Ø© Ø°ÙƒÙŠØ© Ù…Ø¹ Ù…ØªØ§Ø¨Ø¹Ø© ØµØ­ÙŠØ© Ø´Ø§Ù…Ù„Ø©.',emoji:'âŒš',cat:'electronics',badge:'hot',rating:4.9,rCount:89,featured:true,active:true,codeType:'account',codes:[{user:'elite@watch.com',pass:'Watch@2025',note:'Ø±ÙŠØ¬Ù† SA',used:false}]},
  {id:3,name:'Ø­Ù‚ÙŠØ¨Ø© Ø¬Ù„Ø¯ ÙØ§Ø®Ø±Ø©',price:380,desc:'Ø­Ù‚ÙŠØ¨Ø© ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¬Ù„Ø¯ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ.',emoji:'ğŸ‘œ',cat:'fashion',badge:'new',rating:4.7,rCount:56,featured:false,active:true,codeType:'none',codes:[]},
  {id:4,name:'Ø¹Ø·Ø± Noir Luxe',price:320,oldPrice:400,desc:'Ø¹Ø·Ø± ÙØ§Ø®Ø± Ø¨ØªØ±ÙƒÙŠØ¨Ø© Ø´Ø±Ù‚ÙŠØ©.',emoji:'ğŸŒ¹',cat:'accessories',badge:'sale',rating:4.6,rCount:78,featured:true,active:true,codeType:'code',codes:[{val:'NOIR-AA1',used:false},{val:'NOIR-BB2',used:false}]},
  {id:5,name:'Ù„Ø§Ø¨ØªÙˆØ¨ Ø¥Ø¨Ø¯Ø§Ø¹ÙŠ S14',price:3200,desc:'Ù„Ø§Ø¨ØªÙˆØ¨ Ø®ÙÙŠÙ Ø¨Ù…Ø¹Ø§Ù„Ø¬ Ù‚ÙˆÙŠ.',emoji:'ğŸ’»',cat:'electronics',badge:'new',rating:4.9,rCount:34,featured:false,active:true,codeType:'none',codes:[]},
  {id:6,name:'Ø®Ø§ØªÙ… ÙØ¶Ø© Ù†Ù‚ÙŠØ©',price:175,desc:'Ø®Ø§ØªÙ… ÙØ¶Ø© 925 Ø¨ØªØµÙ…ÙŠÙ… Ø£Ù†ÙŠÙ‚.',emoji:'ğŸ’',cat:'accessories',badge:'',rating:4.3,rCount:41,featured:false,active:true,codeType:'none',codes:[]},
  {id:7,name:'Ø­Ø°Ø§Ø¡ Ø±ÙŠØ§Ø¶ÙŠ Aero',price:290,oldPrice:370,desc:'Ø­Ø°Ø§Ø¡ Ø±ÙŠØ§Ø¶ÙŠ Ù…Ø±ÙŠØ­ Ù„Ù„Ø¬Ø±ÙŠ.',emoji:'ğŸ‘Ÿ',cat:'fashion',badge:'sale',rating:4.5,rCount:67,featured:true,active:true,codeType:'none',codes:[]},
  {id:8,name:'Ø¥Ø·Ø§Ø± Ø¯ÙŠÙƒÙˆØ± Ø°Ù‡Ø¨ÙŠ',price:145,desc:'Ø¥Ø·Ø§Ø± ÙØ§Ø®Ø± Ù„Ù…Ù†Ø²Ù„Ùƒ.',emoji:'ğŸ–¼ï¸',cat:'home',badge:'',rating:4.4,rCount:22,featured:false,active:true,codeType:'none',codes:[]}
];

let cart=[], isLoggedIn=false, currentCat='all', currentPd=null, pdQty=1;
let currentUser=null; // {uid, email, name, joinDate}
let _confirmResult=null;
let _authMode='login'; // 'login' | 'register'

// â”€â”€ ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„ â”€â”€
function switchAuthTab(mode){
  _authMode=mode;
  const tLogin=document.getElementById('tab-login');
  const tReg=document.getElementById('tab-register');
  const nameRow=document.getElementById('ls1-name-row');
  const title=document.getElementById('loginSheetTitle');
  const act='background:linear-gradient(135deg,var(--p),var(--s));color:#fff;';
  const inact='background:transparent;color:var(--gr);';
  if(mode==='login'){
    tLogin.style.cssText=tLogin.style.cssText.replace(/background:[^;]+;color:[^;]+;/,'')+act;
    tReg.style.cssText=tReg.style.cssText.replace(/background:[^;]+;color:[^;]+;/,'')+inact;
    nameRow.style.display='none';
    title.textContent='ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ğŸ”‘';
  }else{
    tLogin.style.cssText=tLogin.style.cssText.replace(/background:[^;]+;color:[^;]+;/,'')+inact;
    tReg.style.cssText=tReg.style.cssText.replace(/background:[^;]+;color:[^;]+;/,'')+act;
    nameRow.style.display='block';
    title.textContent='Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ âœ¨';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ğŸ”¥ FIRESTORE â€” Ù…Ø³ØªÙ…Ø¹Ø§Øª Ù„Ø­Ø¸ÙŠØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function startStoreListeners(){
  // Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª â€” Ø£ÙŠ ØªØºÙŠÙŠØ± Ù…Ù† Ø§Ù„Ø¯Ø§Ø´ ÙŠÙØ­Ø¯Ù‘Ø« Ø§Ù„Ù…ØªØ¬Ø± ÙÙˆØ±Ø§Ù‹
  fbDb.collection('storeSettings').doc('config').onSnapshot(doc=>{
    if(!doc.exists)return;
    const data=doc.data();
    const out=JSON.parse(JSON.stringify(DEF));
    for(const k in data){if(data[k]!==null&&typeof data[k]==='object'&&!Array.isArray(data[k]))out[k]=Object.assign({},DEF[k]||{},data[k]);else out[k]=data[k];}
    C=out;
    try{localStorage.setItem('storeConfig',JSON.stringify(C));}catch(e){}
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ØªØ¬Ø±
    const r=document.documentElement.style,col=C.colors;
    r.setProperty('--p',col.primary);r.setProperty('--s',col.secondary);
    r.setProperty('--nv',col.navy);r.setProperty('--nv2',col.navy2||col.navy);
    r.setProperty('--ac',col.accent);r.setProperty('--bg',col.bg);
    buildAll();updateLoginBtn();
  },e=>console.warn('store config listener:',e));

  // Ù…Ø³ØªÙ…Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª â€” ØªØ­Ø¯ÙŠØ« Ù„Ø­Ø¸ÙŠ Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ©/Ø­Ø°Ù/ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬ Ø£Ùˆ ÙƒÙˆØ¯
  fbDb.collection('storeData').doc('products').onSnapshot(doc=>{
    if(!doc.exists||!doc.data().list)return;
    products=doc.data().list;
    try{localStorage.setItem('storeProducts',JSON.stringify(products));}catch(e){}
    refreshProds();
  },e=>console.warn('store products listener:',e));
}

// ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠ Ù…Ù† Firestore Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ù†Ø§Ø¡
async function initStore(){
  try{
    const [cfgDoc,prodsDoc]=await Promise.all([
      fbDb.collection('storeSettings').doc('config').get(),
      fbDb.collection('storeData').doc('products').get()
    ]);
    if(cfgDoc.exists){
      const data=cfgDoc.data();
      const out=JSON.parse(JSON.stringify(DEF));
      for(const k in data){if(data[k]!==null&&typeof data[k]==='object'&&!Array.isArray(data[k]))out[k]=Object.assign({},DEF[k]||{},data[k]);else out[k]=data[k];}
      C=out;
      try{localStorage.setItem('storeConfig',JSON.stringify(C));}catch(e){}
      const r=document.documentElement.style,col=C.colors;
      r.setProperty('--p',col.primary);r.setProperty('--s',col.secondary);
      r.setProperty('--nv',col.navy);r.setProperty('--nv2',col.navy2||col.navy);
      r.setProperty('--ac',col.accent);r.setProperty('--bg',col.bg);
    }
    if(prodsDoc.exists&&prodsDoc.data().list&&prodsDoc.data().list.length){
      products=prodsDoc.data().list;
      try{localStorage.setItem('storeProducts',JSON.stringify(products));}catch(e){}
    }
  }catch(e){console.warn('initStore:',e);}
  buildAll();updateLoginBtn();
  startStoreListeners(); // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ù„Ø­Ø¸ÙŠØ©
}



// Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ù…Ù† Firestore
async function getNextOrderNum(){
  try{
    const ref=fbDb.collection('meta').doc('orderCounter');
    const num=await fbDb.runTransaction(async tx=>{
      const d=await tx.get(ref);
      const next=(d.exists?d.data().value:0)+1;
      tx.set(ref,{value:next});
      return next;
    });
    return '#'+String(num).padStart(4,'0');
  }catch(e){
    // Fallback offline
    const n=(parseInt(localStorage.getItem('orderCounter')||'0')+1);
    localStorage.setItem('orderCounter',n);
    return '#'+String(n).padStart(4,'0');
  }
}

// Ø­ÙØ¸/ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙÙŠ Firestore
async function fbUpsertCustomer(uid,email,name,joinDate){
  try{
    const ref=fbDb.collection('customers').doc(uid);
    const doc=await ref.get();
    if(!doc.exists){
      await ref.set({uid,email:email||'',name:name||'',joinDate:joinDate||new Date().toLocaleDateString('ar-SA'),orders:[],createdAt:firebase.firestore.FieldValue.serverTimestamp()});
    } else {
      const upd={};
      if(name&&!doc.data().name) upd.name=name;
      if(email&&!doc.data().email) upd.email=email;
      if(Object.keys(upd).length) await ref.update(upd);
    }
    return (await ref.get()).data();
  }catch(e){return null;}
}

// Ø­ÙØ¸ Ø·Ù„Ø¨ ÙÙŠ Firestore
async function fbSaveOrder(uid,order){
  try{
    await fbDb.collection('customers').doc(uid).update({orders:firebase.firestore.FieldValue.arrayUnion(order)});
    await fbDb.collection('orders').doc(order.id.replace('#','')).set({...order,uid,savedAt:firebase.firestore.FieldValue.serverTimestamp()});
  }catch(e){console.warn('fbSaveOrder',e);}
}

// Ø¬Ù„Ø¨ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
async function fbGetOrders(uid){
  try{const d=await fbDb.collection('customers').doc(uid).get();return d.exists?(d.data().orders||[]):[];}catch(e){return[];}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ğŸ” Ù†Ø¸Ø§Ù… OTP Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (EmailJS)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let _otpTimerInt = null;   // Ù…Ø¤Ù‚Øª Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
let _otpExpiry   = 0;      // ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ù…Ø²

/* â”€â”€ ØªÙˆÙ„ÙŠØ¯ UID Ù…Ù† Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ (Ù„Ù„Ù€ Firestore) â”€â”€ */
function emailToUid(email){
  // Ù…Ø«Ø§Ù„: user@gmail.com â†’ user_gmail_com
  return 'u_'+email.toLowerCase().replace(/[^a-z0-9]/g,'_');
}

/* â”€â”€ Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² OTP â”€â”€ */
async function doSendOTP(isResend=false){
  const email = document.getElementById('emailF').value.trim();

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ (ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ØµÙŠØºØ© xxx@xxx.xxx)
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
  if(!email || !emailRegex.test(email)){
    showToast('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØµØ­ÙŠØ­ Ù…Ø«Ù„: example@gmail.com');
    document.getElementById('emailF').focus();
    return;
  }

  if(_authMode==='register'){
    const nm=document.getElementById('regName').value.trim();
    if(!nm){showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹');document.getElementById('regName').focus();return;}
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ (3 ÙƒÙ„Ù…Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„)
    const nameParts = nm.split(/\s+/).filter(Boolean);
    if(nameParts.length < 3){
      showToast('âŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ ÙƒØ§Ù…Ù„Ø§Ù‹');
      document.getElementById('regName').focus();
      return;
    }
  }

  if(_authMode==='login' && !isResend){
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù‚Ø¨Ù„ Ø¥Ø±Ø³Ø§Ù„ OTP
    const uid = emailToUid(email);
    try{
      const doc = await fbDb.collection('customers').doc(uid).get();
      if(!doc.exists){
        // Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ â€” Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ÙˆØªØ­ÙˆÙŠÙ„ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
        showToast('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯');
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø´ÙŠØª
        const welcome = document.getElementById('ls1-welcome');
        if(welcome){
          welcome.style.display='block';
          welcome.style.background='rgba(239,68,68,.08)';
          welcome.style.borderColor='rgba(239,68,68,.2)';
          welcome.style.color='var(--re)';
          welcome.innerHTML='âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ â€” ÙŠØ±Ø¬Ù‰ Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹ <span style="color:var(--p);cursor:pointer;font-weight:800;text-decoration:underline;" onclick="switchAuthTab(\'register\')">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</span>';
        }
        return;
      }
    }catch(e){ /* ØªØ¬Ø§Ù‡Ù„ Ø®Ø·Ø£ Ø§Ù„Ø§ØªØµØ§Ù„ ÙˆØ£ÙƒÙ…Ù„ */ }
  }

  const btn=document.getElementById('sendOtpBtn');
  btn.disabled=true;
  btn.textContent='â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';

  // ØªÙˆÙ„ÙŠØ¯ Ø±Ù…Ø² Ø¹Ø´ÙˆØ§Ø¦ÙŠ 6 Ø£Ø±Ù‚Ø§Ù…
  const code = String(Math.floor(100000 + Math.random() * 900000));
  const expiry = Date.now() + 10 * 60 * 1000; // 10 Ø¯Ù‚Ø§Ø¦Ù‚

  try{
    // Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø² ÙÙŠ Firestore Ù…Ø¹ ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
    await fbDb.collection('otpCodes').doc(emailToUid(email)).set({
      code,
      expiry,
      email,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    });

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø² Ø¹Ø¨Ø± EmailJS
 await emailjs.send(
  EMAILJS_CONFIG.serviceId,
  EMAILJS_CONFIG.templateId,
  {
    to_email      : email,   // <â€” Ù‡Ø°Ø§ Ø¶Ø±ÙˆØ±ÙŠ
    otp_code      : code,
    store_name    : C?.meta?.name || 'Ù…ØªØ¬Ø±ÙŠ',
    expiry_min    : '10'
  }
);

    // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø«Ø§Ù†ÙŠØ©
    document.getElementById('ls1').style.display='none';
    document.getElementById('ls2').style.display='block';
    document.getElementById('ls2-email').textContent=email;
    document.querySelectorAll('.otp-box').forEach(b=>{b.value='';});
    setTimeout(()=>document.querySelectorAll('.otp-box')[0]?.focus(),100);

    // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    _otpExpiry=expiry;
    startOtpTimer();

    showToast(isResend ? 'âœ“ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²' : 'âœ“ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ '+email);

  }catch(e){
    console.error('OTP send error:',e);
    showToast('âŒ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª EmailJS');
  }finally{
    btn.disabled=false;
    btn.textContent='Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ ğŸ“§';
  }
}

/* â”€â”€ ØªØ£ÙƒÙŠØ¯ Ø±Ù…Ø² OTP â”€â”€ */
async function doVerifyOTP(){
  const email = document.getElementById('emailF').value.trim();
  const entered = [...document.querySelectorAll('.otp-box')].map(e=>e.value).join('');

  if(entered.length < 6){showToast('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ù…ÙƒÙˆÙ‘Ù† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…');return;}

  const btn=document.getElementById('verifyOtpBtn');
  btn.disabled=true; btn.textContent='â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...';

  try{
    const uid=emailToUid(email);
    const doc=await fbDb.collection('otpCodes').doc(uid).get();

    if(!doc.exists){showToast('âŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ â€” Ø£Ø±Ø³Ù„Ù‡ Ù…Ø¬Ø¯Ø¯Ø§Ù‹');btn.disabled=false;btn.textContent='ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø² âœ“';return;}

    const {code, expiry} = doc.data();

    if(Date.now() > expiry){
      showToast('âŒ Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ù…Ø² â€” Ø£Ø±Ø³Ù„Ù‡ Ù…Ø¬Ø¯Ø¯Ø§Ù‹');
      stopOtpTimer();
      btn.disabled=false; btn.textContent='ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø² âœ“';
      return;
    }

    if(entered !== code){
      showToast('âŒ Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­');
      // ØªÙ„ÙˆÙŠÙ† Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø¨Ø§Ù„Ø£Ø­Ù…Ø±
      document.querySelectorAll('.otp-box').forEach(b=>{b.style.borderColor='var(--re)';});
      setTimeout(()=>document.querySelectorAll('.otp-box').forEach(b=>{b.style.borderColor='';}),1200);
      btn.disabled=false; btn.textContent='ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø² âœ“';
      return;
    }

    // âœ… Ø§Ù„Ø±Ù…Ø² ØµØ­ÙŠØ­ â€” Ø­Ø°ÙÙ‡ Ù…Ù† Firestore
    await fbDb.collection('otpCodes').doc(uid).delete().catch(()=>{});
    stopOtpTimer();

    // Ø¥Ù†Ø´Ø§Ø¡/Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    const nm = _authMode==='register' ? (document.getElementById('regName')?.value?.trim()||'') : '';
    const joinDate = new Date().toLocaleDateString('ar-SA');
    const cdata = await fbUpsertCustomer(uid, email, nm, joinDate);

    currentUser = {uid, email, name: cdata?.name||nm, joinDate: cdata?.joinDate||joinDate};
    isLoggedIn = true;
    updateLoginBtn();

    // Ø­ÙØ¸ Ø§Ù„Ø¬Ù„Ø³Ø© ÙÙŠ localStorage
    try{localStorage.setItem('storeSession',JSON.stringify(currentUser));}catch(e){}

    // Ø¹Ø±Ø¶ Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
    document.getElementById('ls2').style.display='none';
    document.getElementById('ls3').style.display='block';
    const isNew = _authMode==='register'||!cdata?.name;
    document.getElementById('ls3-greeting').textContent = isNew ? 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨Ùƒ! ğŸ‰' : 'Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ! ğŸ‘‹';
    document.getElementById('ls3-name').textContent = currentUser.name||email;
    document.getElementById('ls3-phone').textContent = email;
    setTimeout(()=>closeSheet('loginSheet'),2000);
    showToast((isNew?'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ':'Ø£Ù‡Ù„Ø§Ù‹ ')+(currentUser.name||email)+'! âœ“');

  }catch(e){
    console.error('OTP verify error:',e);
    showToast('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹');
  }finally{
    btn.disabled=false; btn.textContent='ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø² âœ“';
  }
}

/* â”€â”€ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ØµÙ†Ø§Ø¯ÙŠÙ‚ OTP â”€â”€ */
function otpN(el,i){
  el.value=el.value.replace(/[^0-9]/g,'');
  if(el.value.length===1){
    const boxes=document.querySelectorAll('.otp-box');
    if(i<5) boxes[i+1].focus();
    else doVerifyOTP();
  }
}
function otpBack(e,el,i){
  if(e.key==='Backspace'&&!el.value&&i>0)
    document.querySelectorAll('.otp-box')[i-1].focus();
}

/* â”€â”€ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ â”€â”€ */
function startOtpTimer(){
  stopOtpTimer();
  function tick(){
    const rem=Math.max(0,Math.ceil((_otpExpiry-Date.now())/1000));
    const m=String(Math.floor(rem/60)).padStart(2,'0');
    const s=String(rem%60).padStart(2,'0');
    const el=document.getElementById('otpTimer');
    if(el){
      el.textContent=`${m}:${s}`;
      el.style.color=rem<=60?'var(--re)':'var(--p)';
    }
    if(rem<=0){stopOtpTimer();showToast('â° Ø§Ù†ØªÙ‡Øª ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø±Ù…Ø²');}
  }
  tick();
  _otpTimerInt=setInterval(tick,1000);
}
function stopOtpTimer(){clearInterval(_otpTimerInt);_otpTimerInt=null;}

/* â”€â”€ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ â”€â”€ */
function backToEmail(){
  stopOtpTimer();
  document.getElementById('ls2').style.display='none';
  document.getElementById('ls1').style.display='block';
  document.querySelectorAll('.otp-box').forEach(b=>b.value='');
}

/* â”€â”€ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ â”€â”€ */
function doLogout(){
  isLoggedIn=false; currentUser=null; _authMode='login';
  try{localStorage.removeItem('storeSession');}catch(e){}
  updateLoginBtn();
  backToEmail();
  document.getElementById('ls1').style.display='block';
  ['ls2','ls3'].forEach(id=>document.getElementById(id).style.display='none');
  document.getElementById('emailF').value='';
  try{document.getElementById('regName').value='';}catch(e){}
  document.getElementById('ls1-welcome').style.display='none';
  switchAuthTab('login');
  showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
}

/* â”€â”€ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† localStorage â”€â”€ */
(async function restoreSession(){
  try{
    const s=localStorage.getItem('storeSession');
    if(!s)return;
    const saved=JSON.parse(s);
    if(!saved?.uid||!saved?.email)return;
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯Ù‡ ÙÙŠ Firestore
    const doc=await fbDb.collection('customers').doc(saved.uid).get();
    if(doc.exists){
      const d=doc.data();
      currentUser={uid:saved.uid,email:saved.email,name:d.name||saved.name||'',joinDate:d.joinDate||saved.joinDate||''};
      isLoggedIn=true;
      updateLoginBtn();
      const w=document.getElementById('ls1-welcome');
      if(w&&currentUser.name){w.style.display='block';w.textContent='Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø¹ÙˆØ¯ØªÙƒ '+currentUser.name+' ğŸ‘‹';}
    }else{
      localStorage.removeItem('storeSession');
    }
  }catch(e){}
})();

// â•â•â•â•â•â•â•â• BUILD SECTIONS â•â•â•â•â•â•â•â•
function buildAll(){
  document.getElementById('pgTitle').textContent=C.meta.name;
  buildAnnounce();buildLogo();buildNav();buildHActions();
  buildHero();buildTrust();buildCats();buildPromo();
  buildMobileNav();buildFooter();buildReviews();refreshProds();
  updateDarkBtnIcons();
}

function buildAnnounce(){
  const bar=document.getElementById('announceBar');
  if(!C.announce.on){bar.style.display='none';return;}
  bar.style.display='flex';
  bar.style.background=`linear-gradient(90deg,${C.colors.navy},${C.colors.primary},${C.colors.secondary},${C.colors.primary},${C.colors.navy})`;
  const items=[...C.announce.items,...C.announce.items];
  document.getElementById('atrack').innerHTML=items.map(t=>`<div class="ait">${t}</div>`).join('');
  document.getElementById('atrack').style.animationDuration=(C.announce.speed||28)+'s';
}

function buildLogo(){
  const el=document.getElementById('storeLogo');
  const ico=C.meta.logoImg
    ?`<div class="logo-icon"><img src="${C.meta.logoImg}" alt="logo"></div>`
    :`<div class="logo-icon" style="background:linear-gradient(135deg,${C.colors.primary},${C.colors.secondary})">${C.meta.logoLetter}</div>`;
  el.innerHTML=ico+`<div><div class="logo-name">${C.meta.logoText}</div>${C.meta.tagline?`<div class="logo-tag">${C.meta.tagline}</div>`:''}</div>`;
}

function buildNav(){
  document.getElementById('navLinks').innerHTML=C.nav.map(n=>`
    <li><a href="${n.url||'#'}" ${n.cat?`onclick="openCatPage('${n.cat}');return false;"`:''} style="${n.hl?'color:var(--re);font-weight:800;':''}">${n.label}</a></li>`).join('');
}

function buildHActions(){
  document.getElementById('hactions').innerHTML=`
    <button class="hbtn" id="darkModeBtn" onclick="toggleDark()" title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†" style="font-size:1rem;padding:.45rem .6rem;">ğŸŒ™</button>
    <button class="hbtn" id="loginBtn" onclick="isLoggedIn?openMyOrders():openSheet('loginSheet')">ğŸ”‘ Ø¯Ø®ÙˆÙ„</button>
    <button class="hbtn primary" onclick="openSheet('cartSheet')">ğŸ›’ Ø§Ù„Ø³Ù„Ø© <span class="cc" id="cartCount">0</span></button>`;
}
function updateLoginBtn(){
  const btn=document.getElementById('loginBtn');
  if(!btn)return;
  btn.innerHTML=isLoggedIn&&currentUser?`ğŸ‘¤ ${currentUser.name||currentUser.email}`:'ğŸ”‘ Ø¯Ø®ÙˆÙ„';
  btn.onclick=isLoggedIn?openMyOrders:()=>openSheet('loginSheet');
}

function buildHero(){
  const h=C.hero,col=C.colors;
  document.getElementById('heroSection').style.background=`linear-gradient(135deg,${col.navy} 0%,${col.navy2||col.navy} 40%,#1e1065 100%)`;
  ['tag','l1','l2','desc'].forEach(k=>document.getElementById('hero'+k.charAt(0).toUpperCase()+k.slice(1)).textContent=h[k]);
  document.getElementById('hBtn1').textContent=h.btn1;
  document.getElementById('hBtn2').textContent=h.btn2;
  document.getElementById('heroDeco').textContent=h.deco||'ğŸ›ï¸';
  document.getElementById('heroStats').innerHTML=`
    <div><div class="hsn">${h.s1v}</div><div class="hsl">${h.s1l}</div></div>
    <div><div class="hsn">${h.s2v}</div><div class="hsl">${h.s2l}</div></div>
    <div><div class="hsn">${h.s3v}</div><div class="hsl">${h.s3l}</div></div>`;
}

function buildTrust(){
  document.getElementById('trustBar').innerHTML=C.trust.map((t,i)=>
    `${i?'<div class="tdv"></div>':''}<div class="ti"><div class="ti-ic">${t.icon}</div><div><div class="ti-ttl">${t.title}</div><div class="ti-sub">${t.desc}</div></div></div>`
  ).join('');
}

function buildCats(){
  document.getElementById('catsGrid').innerHTML=C.cats.map(c=>`
    <div class="ccard" style="background:linear-gradient(135deg,${c.color})" onclick="openCatPage('${c.key}')">
      <div class="cbg">${c.icon}</div><div class="cov"></div>
      <div class="clbl">${c.label}<br><span class="ccount">${c.count}</span></div>
    </div>`).join('');
}

function buildPromo(){
  const p=C.promo;
  if(!p.on){document.getElementById('promoWrap').style.display='none';return;}
  document.getElementById('promoWrap').style.display='block';
  document.getElementById('promoBnr').style.background=`linear-gradient(135deg,${p.bg||C.colors.navy+','+C.colors.primary})`;
  document.getElementById('promoTag').textContent=p.tag;
  document.getElementById('promoTitle').textContent=p.title;
  document.getElementById('promoDesc').textContent=p.desc;
  const btn=document.getElementById('promoBtn');
  btn.textContent=p.btn;btn.style.color=C.colors.primary;
  btn.onclick=()=>openCatPage(p.cat||'');
}

function buildMobileNav(){
  document.getElementById('mnItems').innerHTML=C.mobileNav.map((item,i)=>`
    <button class="mn-item ${i===0?'act':''}" onclick="handleMN('${item.action}')">
      <span class="mn-ic">${item.icon}</span>${item.label}
    </button>`).join('');
}
function handleMN(a){
  ({home:()=>scrollTo({top:0,behavior:'smooth'}),cart:()=>openSheet('cartSheet'),
    login:()=>isLoggedIn?openMyOrders():openSheet('loginSheet'),
    offers:()=>openCatPage('sale'),
    whatsapp:()=>{const w=C.social.find(s=>s.id==='whatsapp');if(w&&w.url)window.open(w.url,'_blank');},
    dashboard:()=>location.href='dashboard.html'
  }[a]||{home:()=>scrollTo({top:0,behavior:'smooth'})}.home)();
}

function buildFooter(){
  const f=C.footer,col=C.colors;
  document.getElementById('siteFooter').style.background=col.footerBg||col.navy;
  const socs=C.social.filter(s=>s.on&&s.url).map(s=>`<a class="soc" href="${s.url}" target="_blank">${s.icon}</a>`).join('');
  document.getElementById('footerTop').innerHTML=`
    <div>
      ${C.meta.logoImg
        ?`<div class="fbl"><div class="fbi"><img src="${C.meta.logoImg}" alt></div><div class="fbn">${C.meta.logoText}</div></div>`
        :`<div class="fbl"><div class="fbi" style="background:linear-gradient(135deg,${col.primary},${col.secondary})">${C.meta.logoLetter}</div><div class="fbn">${C.meta.logoText}</div></div>`}
      <p class="fbd">${f.desc}</p><div class="socs">${socs}</div>
    </div>
    <div><div class="fct">${f.c1t}</div><ul class="fls">${f.c1.map(l=>`<li><a href="${l.u}">${l.l}</a></li>`).join('')}</ul></div>
    <div><div class="fct">${f.c2t}</div><ul class="fls">${f.c2.map(l=>`<li><a href="${l.u}">${l.l}</a></li>`).join('')}</ul></div>
    <div><div class="fct">${f.c3t}</div><ul class="fls">${f.c3.map(l=>`<li><a href="${l.u}">${l.l}</a></li>`).join('')}</ul></div>`;
  document.getElementById('footerBot').innerHTML=`
    <div class="ftcp">${f.copy}</div>
    <div class="paybdgs">${(f.pay||[]).map(b=>`<div class="paybdg">${b}</div>`).join('')}</div>`;
}

function buildReviews(){
  document.getElementById('reviewsGrid').innerHTML=C.reviews.map(r=>`
    <div class="rc2">
      <div class="rh"><div class="rav" style="${r.clr?`background:linear-gradient(135deg,${r.clr})`:`background:linear-gradient(135deg,${C.colors.primary},${C.colors.secondary})`}">${r.ini}</div>
      <div><div class="rnm">${r.name}</div><div class="rdt">${r.date}</div></div></div>
      <div class="rst">${'â˜…'.repeat(r.stars)}${'â˜†'.repeat(5-r.stars)}</div>
      <div class="rtx">${r.text}</div><div class="rprd">${r.prod}</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â• PRODUCTS â•â•â•â•â•â•â•â•
function renderProds(list,gid){
  const g=document.getElementById(gid),cur=C.store.currency||'Ø±.Ø³';
  if(!list||!list.length){g.innerHTML='<div style="color:var(--gr);grid-column:1/-1;text-align:center;padding:2rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</div>';return;}
  g.innerHTML=list.filter(p=>p.active).map(p=>{
    const avail=p.codeType!=='none'?p.codes.filter(c=>!c.used).length:null;
    const sold=avail===0;
    const disc=p.oldPrice?Math.round((1-p.price/p.oldPrice)*100):0;
    return `<div class="pc" onclick="${sold?'':'openProd('+p.id+')'}" style="${sold?'opacity:.65;':''}">
      <div class="pth">
        ${p.badge==='new'?'<span class="pbdg bnn">Ø¬Ø¯ÙŠØ¯</span>':p.badge==='sale'?'<span class="pbdg bns">-'+disc+'%</span>':p.badge==='hot'?'<span class="pbdg bnh">ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø±</span>':''}
        <button class="wbtn" onclick="event.stopPropagation();showToast('â¤ï¸ ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©')">â™¡</button>
        ${p.emoji}
        ${p.codeType!=='none'?`<div class="dcbdg">${p.codeType==='account'?'ğŸ‘¤':'ğŸ”‘'} ${avail} Ù…ØªØ§Ø­</div>`:''}
      </div>
      <div class="pb">
        <div class="pnm">${p.name}</div>
        <div class="prt"><span class="sts">${'â˜…'.repeat(Math.floor(p.rating))}${'â˜†'.repeat(5-Math.floor(p.rating))}</span><span class="rc">(${p.rCount})</span></div>
        <div class="ppr">
          <div>
            <div class="pp">${p.price} ${cur}</div>
            ${p.oldPrice?`<div class="po">${p.oldPrice} ${cur}</div>`:''}
          </div>
          ${sold?'<span style="font-size:.75rem;color:var(--re);font-weight:700;">Ù†ÙØ¯</span>':`<button class="abtn" onclick="event.stopPropagation();quickAdd(${p.id})">+</button>`}
        </div>
      </div>
    </div>`;
  }).join('');
}
function refreshProds(){
  const list=currentCat==='all'?products:products.filter(p=>p.cat===currentCat);
  renderProds(list,'prodsGrid');
  renderProds(products.filter(p=>p.featured),'featGrid');
}
function filterCat(cat){
  currentCat=cat;
  const found=C.cats.find(c=>c.key===cat);
  document.getElementById('prodsTitle').textContent=found?found.label:'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª';
  document.getElementById('prodsec').scrollIntoView({behavior:'smooth'});
  refreshProds();
}
function showAll(){currentCat='all';document.getElementById('prodsTitle').textContent='Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª';refreshProds();}
function liveSearch(){
  const q=document.getElementById('searchInp').value.trim().toLowerCase();
  if(!q){refreshProds();return;}
  renderProds(products.filter(p=>p.name.toLowerCase().includes(q)||p.desc.toLowerCase().includes(q)),'prodsGrid');
}

// â•â•â•â•â•â•â•â• SHEETS â•â•â•â•â•â•â•â•
function openSheet(id){if(id==='cartSheet')renderCart();document.getElementById(id).classList.add('open');}
function closeSheet(id){document.getElementById(id).classList.remove('open');}
function bgClose(e,id){if(e.target.id===id)closeSheet(id);}

// â•â•â•â•â•â•â•â• DARK MODE â•â•â•â•â•â•â•â•
let _dark=false;
try{_dark=localStorage.getItem('darkMode')==='1';}catch(e){}
if(_dark)document.documentElement.classList.add('dark');
function toggleDark(){
  _dark=!_dark;
  document.documentElement.classList.toggle('dark',_dark);
  try{localStorage.setItem('darkMode',_dark?'1':'0');}catch(e){}
  const btns=[document.getElementById('darkBtn'),document.getElementById('darkModeBtn')];
  btns.forEach(b=>{if(b)b.textContent=_dark?'â˜€ï¸':'ğŸŒ™';});
}
// ØªØ·Ø¨ÙŠÙ‚ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø¯Ø§ÙƒÙ† Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡
function updateDarkBtnIcons(){
  const btns=[document.getElementById('darkBtn'),document.getElementById('darkModeBtn')];
  btns.forEach(b=>{if(b)b.textContent=_dark?'â˜€ï¸':'ğŸŒ™';});
}

// â•â•â•â•â•â•â•â• PRODUCT FULL PAGE â•â•â•â•â•â•â•â•
function openProdPage(id){
  const p=products.find(x=>x.id===id);
  if(!p)return;
  currentPd=p; pdQty=1;
  const cur=C.store.currency||'Ø±.Ø³';
  const disc=p.oldPrice?Math.round((1-p.price/p.oldPrice)*100):0;
  const avail=p.codes?p.codes.filter(c=>!c.used).length:null;
  document.getElementById('pfpTitle').textContent=p.name;
  // Ø¨Ù†Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø©
  const existingRevs=(window._prodReviews&&window._prodReviews[id])||[];
  const revHtml=existingRevs.length
    ?existingRevs.map(r=>`<div class="rev-card"><div style="display:flex;align-items:center;justify-content:space-between;"><div><div class="rev-author">${r.name}</div><div class="rev-date">${r.date}</div></div><div style="color:var(--st);">${'â˜…'.repeat(r.stars)}${'â˜†'.repeat(5-r.stars)}</div></div><div class="rev-text">${r.text}</div></div>`).join('')
    :'<div style="color:var(--gr);font-size:.85rem;text-align:center;padding:1rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯ â€” ÙƒÙ† Ø§Ù„Ø£ÙˆÙ„!</div>';
  document.getElementById('pfpBody').innerHTML=`
    <div class="pfp-img">${p.emoji}</div>
    ${p.badge?`<span class="pbdg ${p.badge==='new'?'bnn':p.badge==='sale'?'bns':'bnh'}" style="display:inline-block;margin-bottom:.5rem;">${p.badge==='new'?'Ø¬Ø¯ÙŠØ¯':p.badge==='sale'?'ØªØ®ÙÙŠØ¶':'ğŸ”¥ Ø§Ù„Ø£ÙƒØ«Ø±'}</span>`:''}
    <div class="pfp-meta">
      <div>
        <h2 style="font-size:1.3rem;font-weight:900;margin-bottom:.5rem;">${p.name}</h2>
        <div style="display:flex;align-items:center;gap:.5rem;margin-bottom:.7rem;">
          <span style="color:var(--st);font-size:1rem;">${'â˜…'.repeat(Math.floor(p.rating))}${'â˜†'.repeat(5-Math.floor(p.rating))}</span>
          <span style="font-size:.82rem;color:var(--gr);">${p.rating} (${p.rCount} ØªÙ‚ÙŠÙŠÙ…)</span>
        </div>
        <div>
          <span class="pfp-price-big">${p.price} ${cur}</span>
          ${p.oldPrice?`<span class="pfp-old">${p.oldPrice} ${cur}</span><span class="pfp-disc">-${disc}%</span>`:''}
        </div>
      </div>
      ${p.codeType!=='none'?`<div style="background:rgba(109,40,217,.07);border:1px solid rgba(109,40,217,.15);border-radius:11px;padding:.6rem .9rem;font-size:.82rem;text-align:center;">${p.codeType==='account'?'ğŸ‘¤':'ğŸ”‘'}<br><strong>${avail}</strong><br><span style="font-size:.72rem;color:var(--gr);">Ù…ØªØ§Ø­</span></div>`:''}
    </div>
    <p style="color:var(--tx2);font-size:.9rem;line-height:1.8;margin-bottom:1.2rem;">${p.desc}</p>
    ${p.codeType!=='none'?`<div style="background:rgba(109,40,217,.06);border:1px solid rgba(109,40,217,.15);border-radius:11px;padding:.8rem 1rem;margin-bottom:1rem;font-size:.85rem;">${p.codeType==='account'?'ğŸ‘¤':'ğŸ”‘'} <strong>Ù…Ù†ØªØ¬ Ø±Ù‚Ù…ÙŠ</strong> â€” ØªØ­ØµÙ„ ÙÙˆØ±Ø§Ù‹ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹.</div>`:''}
    <div class="pfp-actions">
      <div style="display:flex;align-items:center;gap:.6rem;background:#fff;border-radius:10px;padding:.5rem .8rem;border:1px solid var(--bd);">
        <button onclick="pfpChQ(-1)" style="background:none;border:none;font-size:1.3rem;cursor:pointer;color:var(--p);font-weight:900;line-height:1;">âˆ’</button>
        <span id="pfpQty" style="font-size:1rem;font-weight:800;min-width:24px;text-align:center;">1</span>
        <button onclick="pfpChQ(1)" style="background:none;border:none;font-size:1.3rem;cursor:pointer;color:var(--p);font-weight:900;line-height:1;">+</button>
      </div>
      <button class="pfp-add-btn" onclick="pfpAddToCart()">ğŸ›’ Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
    </div>
    <hr class="pfp-divider">
    <div class="rev-section">
      <div class="rev-hd"><div class="rev-ttl">â­ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</div></div>
      <div id="pfpRevList">${revHtml}</div>
      ${isLoggedIn?`
      <div class="rev-form">
        <div style="font-size:.88rem;font-weight:700;margin-bottom:.5rem;">Ø£Ø¶Ù ØªÙ‚ÙŠÙŠÙ…Ùƒ</div>
        <div class="rev-stars-inp" id="pfpStarsInp">
          ${[1,2,3,4,5].map(s=>`<span class="rev-star" data-s="${s}" onclick="pfpSetStar(${s})">â˜…</span>`).join('')}
        </div>
        <textarea class="fi" id="pfpRevText" placeholder="Ø´Ø§Ø±ÙƒÙ†Ø§ ØªØ¬Ø±Ø¨ØªÙƒ Ù…Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬..." rows="3" style="margin-bottom:.7rem;"></textarea>
        <button class="btn-pri" style="width:100%;" onclick="pfpSubmitRev(${p.id})">Ù†Ø´Ø± Ø§Ù„ØªÙ‚ÙŠÙŠÙ… âœ“</button>
      </div>`:`<div style="text-align:center;font-size:.82rem;color:var(--gr);margin-top:.8rem;"><span style="color:var(--p);cursor:pointer;font-weight:700;" onclick="closeSheet('pdSheet');closeProdPage();openSheet('loginSheet')">Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ</span> Ù„Ø¥Ø¶Ø§ÙØ© ØªÙ‚ÙŠÙŠÙ…</div>`}
    </div>`;
  history.pushState({page:'product',id},'',`#product-${id}`);
  document.getElementById('prodFullPage').classList.add('open');
  document.body.style.overflow='hidden';
  window.scrollTo(0,0);
}
function closeProdPage(){
  document.getElementById('prodFullPage').classList.remove('open');
  document.body.style.overflow='';
  if(history.state&&history.state.page==='product')history.back();
}
function pfpChQ(d){pdQty=Math.max(1,pdQty+d);document.getElementById('pfpQty').textContent=pdQty;}
function pfpAddToCart(){for(let i=0;i<pdQty;i++)quickAdd(currentPd.id);closeProdPage();}
let _pfpStars=5;
function pfpSetStar(n){
  _pfpStars=n;
  document.querySelectorAll('.rev-star').forEach((s,i)=>{s.classList.toggle('sel',i<n);});
}
async function pfpSubmitRev(pid){
  const text=document.getElementById('pfpRevText').value.trim();
  if(!text){showToast('Ø§ÙƒØªØ¨ ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø£ÙˆÙ„Ø§Ù‹');return;}
  const rev={name:currentUser.name||'Ù…Ø³ØªØ®Ø¯Ù…',date:new Date().toLocaleDateString('ar-SA'),stars:_pfpStars,text};
  if(!window._prodReviews)window._prodReviews={};
  if(!window._prodReviews[pid])window._prodReviews[pid]=[];
  window._prodReviews[pid].unshift(rev);
  // Ù…Ø­Ø§ÙˆÙ„Ø© Ø­ÙØ¸ ÙÙŠ Firestore
  try{await fbDb.collection('productReviews').doc(String(pid)).set({reviews:window._prodReviews[pid]},{merge:true});}catch(e){}
  // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
  document.getElementById('pfpRevList').innerHTML=window._prodReviews[pid].map(r=>`<div class="rev-card"><div style="display:flex;align-items:center;justify-content:space-between;"><div><div class="rev-author">${r.name}</div><div class="rev-date">${r.date}</div></div><div style="color:var(--st);">${'â˜…'.repeat(r.stars)}${'â˜†'.repeat(5-r.stars)}</div></div><div class="rev-text">${r.text}</div></div>`).join('');
  document.querySelector('.rev-form').innerHTML='<div style="text-align:center;padding:1rem;color:var(--gn);font-weight:700;">âœ“ ØªÙ… Ù†Ø´Ø± ØªÙ‚ÙŠÙŠÙ…Ùƒ! Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ</div>';
  showToast('âœ“ ØªÙ… Ù†Ø´Ø± ØªÙ‚ÙŠÙŠÙ…Ùƒ!');
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…Ù† Firestore
async function loadProdReviews(pid){
  try{
    const doc=await fbDb.collection('productReviews').doc(String(pid)).get();
    if(doc.exists&&doc.data().reviews){
      if(!window._prodReviews)window._prodReviews={};
      window._prodReviews[pid]=doc.data().reviews;
    }
  }catch(e){}
}

// â•â•â•â•â•â•â•â• CATEGORY PAGE â•â•â•â•â•â•â•â•
function openCatPage(catKey){
  const cat=C.cats.find(c=>c.key===catKey)||{label:catKey==='all'?'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª':'Ø¹Ø±ÙˆØ¶ Ø®Ø§ØµØ©',icon:'ğŸ›ï¸',count:''};
  const list=products.filter(p=>p.active&&(catKey==='all'||p.cat===catKey));
  document.getElementById('cpName').textContent=(cat.icon?cat.icon+' ':'')+cat.label;
  document.getElementById('cpCount').textContent=list.length+' Ù…Ù†ØªØ¬';
  renderProds(list,'cpGrid');
  history.pushState({page:'category',cat:catKey},'',`#cat-${catKey}`);
  document.getElementById('catPage').classList.add('open');
  document.body.style.overflow='hidden';
  document.getElementById('catPage').scrollTop=0;
}
function closeCatPage(){
  document.getElementById('catPage').classList.remove('open');
  document.body.style.overflow='';
  if(history.state&&history.state.page==='category')history.back();
}

// Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹
window.addEventListener('popstate',e=>{
  if(document.getElementById('prodFullPage').classList.contains('open')){
    document.getElementById('prodFullPage').classList.remove('open');
    document.body.style.overflow='';
  }
  if(document.getElementById('catPage').classList.contains('open')){
    document.getElementById('catPage').classList.remove('open');
    document.body.style.overflow='';
  }
});

// PRODUCT DETAIL (Ø§Ù„Ø´ÙŠØª Ø§Ù„Ù‚Ø¯ÙŠÙ… - Ø§Ø³ØªØ¨Ø¯Ù„Ù†Ø§Ù‡ Ø¨Ø§Ù„ØµÙØ­Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©)
function openProd(id){openProdPage(id);}
function chQ(d){pfpChQ(d);}
function addFromPd(){pfpAddToCart();}

// CART
function quickAdd(id){
  const p=products.find(x=>x.id===id);
  const avail=p.codeType!=='none'?p.codes.filter(c=>!c.used).length:99;
  const inCart=cart.filter(x=>x.id===id).reduce((s,x)=>s+x.qty,0);
  if(p.codeType!=='none'&&inCart>=avail){showToast('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø®Ø²ÙˆÙ† ÙƒØ§ÙÙ');return;}
  const ex=cart.find(x=>x.id===id);
  if(ex)ex.qty++;else cart.push({...p,qty:1});
  document.getElementById('cartCount').textContent=cart.reduce((s,i)=>s+i.qty,0);
  showToast('âœ“ ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©');
}
function rmCI(id){cart=cart.filter(i=>i.id!==id);document.getElementById('cartCount').textContent=cart.reduce((s,i)=>s+i.qty,0);renderCart();}
function chCI(id,d){const i=cart.find(x=>x.id===id);if(i){i.qty+=d;if(i.qty<=0)rmCI(id);}document.getElementById('cartCount').textContent=cart.reduce((s,i)=>s+i.qty,0);renderCart();}

function renderCart(){
  const cur=C.store.currency||'Ø±.Ø³',b=document.getElementById('cartBody');
  if(!cart.length){b.innerHTML='<div class="ce"><div style="font-size:3.5rem;">ğŸ›’</div><p>Ø³Ù„ØªÙƒ ÙØ§Ø±ØºØ©!</p></div>';return;}
  const sub=cart.reduce((s,i)=>s+i.price*i.qty,0);
  const ship=sub>=C.store.freeShip?0:C.store.shipFee;
  b.innerHTML=cart.map(i=>`
    <div class="ci"><div class="ci-img">${i.emoji}</div>
    <div class="ci-info">
      <div class="ci-nm">${i.name}${i.codeType!=='none'?`<span style="font-size:.65rem;color:var(--p);background:rgba(109,40,217,.1);padding:.1rem .4rem;border-radius:4px;margin-right:.4rem;">${i.codeType==='account'?'ğŸ‘¤':'ğŸ”‘'}</span>`:''}</div>
      <div class="ci-pr">${i.price} ${cur}</div>
      <div class="ci-qty"><button onclick="chCI(${i.id},-1)">âˆ’</button><span>${i.qty}</span><button onclick="chCI(${i.id},1)">+</button></div>
    </div><button class="ci-rm" onclick="rmCI(${i.id})">âœ•</button></div>`).join('')+`
  <div class="csum"><div class="crow"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</span><span>${sub} ${cur}</span></div><div class="crow"><span>Ø§Ù„Ø´Ø­Ù†</span><span>${ship?ship+' '+cur:'Ù…Ø¬Ø§Ù†ÙŠ'}</span></div><div class="crow tot"><span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span>${sub+ship} ${cur}</span></div></div>
  <button class="btn-co" onclick="openCheckout()">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ â†’</button>`;
}

// CHECKOUT
function openCheckout(){
  if(!isLoggedIn){closeSheet('cartSheet');openSheet('loginSheet');showToast('Ø³Ø¬Ù‘Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø£ÙˆÙ„Ø§Ù‹');return;}
  const cur=C.store.currency||'Ø±.Ø³';
  const sub=cart.reduce((s,i)=>s+i.price*i.qty,0);
  const ship=sub>=C.store.freeShip?0:C.store.shipFee;
  const tot=sub+ship,hasD=cart.some(i=>i.codeType!=='none');
  const payOpts=['ğŸ’³ Ø¨Ø·Ø§Ù‚Ø© Ù…Ø¯Ù‰ / Ø§Ø¦ØªÙ…Ø§Ù†ÙŠØ©','ğŸ Apple Pay','ğŸ“± STC Pay'];
  if(C.store.cod&&!hasD)payOpts.push('ğŸ’µ Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…');
  document.getElementById('coBody').innerHTML=`
    ${hasD?'<div style="background:rgba(109,40,217,.06);border:1px solid rgba(109,40,217,.15);border-radius:11px;padding:.8rem 1rem;margin-bottom:1rem;font-size:.85rem;">âš¡ <strong>Ù…Ù†ØªØ¬Ø§Øª Ø±Ù‚Ù…ÙŠØ©</strong> â€” Ø³ØªØ­ØµÙ„ Ø¹Ù„Ù‰ ÙƒÙˆØ¯Ùƒ ÙÙˆØ±Ø§Ù‹</div>':''}
    <div class="fg"><label class="fl">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label><input type="text" class="fi" id="coName" value="${currentUser?.name||''}" placeholder="Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡"></div>
    <div class="fg"><label class="fl">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label><input type="email" class="fi" id="coEmail" value="${currentUser?.email||''}" readonly style="background:#f8f7ff;color:var(--gr);"></div>
    ${!hasD?'<div class="fg"><label class="fl">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input type="text" class="fi" id="coAddr" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø§Ù„Ø­ÙŠØŒ Ø§Ù„Ø´Ø§Ø±Ø¹"></div>':''}
    <div class="fg"><label class="fl">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
      <div class="pay-opts">${payOpts.map((o,i)=>`<div class="pay-opt${i===0?' sel':''}" onclick="selPay(this)">${o}</div>`).join('')}</div>
    </div>
    <div class="csum"><div class="crow"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</span><span>${sub} ${cur}</span></div><div class="crow"><span>Ø§Ù„Ø´Ø­Ù†</span><span>${ship?ship+' '+cur:'Ù…Ø¬Ø§Ù†ÙŠ'}</span></div><div class="crow tot"><span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span>${tot} ${cur}</span></div></div>
    <button class="btn-pri" id="placeOrderBtn" onclick="placeOrder(${tot})">âœ“ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ø¯ÙØ¹</button>`;
  closeSheet('cartSheet');openSheet('coSheet');
}
function selPay(el){document.querySelectorAll('.pay-opt').forEach(e=>e.classList.remove('sel'));el.classList.add('sel');}

// â•â•â•â•â•â•â•â• ğŸ”¥ PLACE ORDER â•â•â•â•â•â•â•â•
async function placeOrder(tot){
  const btn=document.getElementById('placeOrderBtn');
  if(btn){btn.disabled=true;btn.textContent='â³ Ø¬Ø§Ø±ÙŠ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨...';}

  const name=document.getElementById('coName')?.value?.trim()||'';
  const email=currentUser?.email||'';
  if(!name){showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ');if(btn){btn.disabled=false;btn.textContent='âœ“ ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ§Ù„Ø¯ÙØ¹';}return;}

  const cur=C.store.currency||'Ø±.Ø³';
  const orderId=await getNextOrderNum(); // ğŸ”¥ Ø±Ù‚Ù… Ù…Ù† Firebase
  const payMethod=document.querySelector('.pay-opt.sel')?.textContent?.trim()||'Ø¨Ø·Ø§Ù‚Ø©';
  const date=new Date().toLocaleDateString('ar-SA');

  // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù…Ù† localStorage
  const delivered=[];
  cart.forEach(item=>{
    if(item.codeType==='none')return;
    const prod=products.find(p=>p.id===item.id);
    for(let q=0;q<item.qty;q++){
      const a=prod.codes.find(c=>!c.used);
      if(a){a.used=true;delivered.push({product:item,code:a});}
    }
  });
  try{localStorage.setItem('storeProducts',JSON.stringify(products));}catch(e){}

  // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„
  if(currentUser&&name)currentUser.name=name;

  // ğŸ”¥ Ø­ÙØ¸ ÙÙŠ Firestore
  if(currentUser?.uid){
    await fbUpsertCustomer(currentUser.uid,email,name,currentUser.joinDate);
    const orderRecord={
      id:orderId,date,
      products:cart.map(i=>i.emoji+' '+i.name+'('+i.qty+')').join('ØŒ '),
      total:tot,status:'done',payMethod,currency:cur,
      codes:delivered.map(d=>d.product.codeType==='account'
        ?{type:'account',product:d.product.name,user:d.code.user,pass:d.code.pass,note:d.code.note||''}
        :{type:'code',product:d.product.name,val:d.code.val}
      )
    };
    await fbSaveOrder(currentUser.uid,orderRecord);
  }

  updateLoginBtn();
  closeSheet('coSheet');
  cart=[];
  document.getElementById('cartCount').textContent=0;
  refreshProds();

  if(delivered.length){showDelivery(orderId,name,email,tot,cur,delivered);}
  else{
    if(C.delivery.sendOwner)notifyOwner(orderId,name,email,tot,[]);
    showToast('âœ“ ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ '+orderId+' Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.');
  }
}

function buildMsg(orderId,name,delivered){
  let block='';
  delivered.forEach(d=>{block+=d.product.codeType==='account'
    ?`${d.product.emoji} ${d.product.name}\nğŸ‘¤ Ø§Ù„ÙŠÙˆØ²Ø±: ${d.code.user}\nğŸ”’ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯: ${d.code.pass}${d.code.note?'\nğŸ“ '+d.code.note:''}\n\n`
    :`${d.product.emoji} ${d.product.name}\nğŸ”‘ Ø§Ù„ÙƒÙˆØ¯: ${d.code.val}\n\n`;});
  return (C.delivery.msg||DEF.delivery.msg)
    .replace('{store}',C.meta.name).replace('{order}',orderId)
    .replace('{product}',delivered.map(d=>d.product.name).join('ØŒ ')).replace('{codeBlock}',block.trim());
}

function notifyOwner(orderId,name,email,tot,delivered){
  const msg=`ğŸ”” Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯!\n\nØ±Ù‚Ù…: ${orderId}\nØ§Ù„Ø¹Ù…ÙŠÙ„: ${name}\nØ§Ù„Ø¨Ø±ÙŠØ¯: ${email}\nØ§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${tot} ${C.store.currency||'Ø±.Ø³'}`;
  const wa=C.delivery.ownerWA||'';
  if(wa)setTimeout(()=>window.open(`https://wa.me/${wa}?text=${encodeURIComponent(msg)}`,'_blank'),800);
}

function showDelivery(orderId,name,email,tot,cur,delivered){
  const hasAcc=delivered.some(d=>d.product.codeType==='account');
  document.getElementById('dlvHead').innerHTML=`<div class="dlv-ic">${hasAcc?'ğŸ‘¤':'ğŸ”‘'}</div><div class="dlv-ttl">ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ! ğŸ‰</div><div class="dlv-sub">Ø¥Ù„ÙŠÙƒ Ù…Ø­ØªÙˆØ§Ùƒ Ø§Ù„Ø±Ù‚Ù…ÙŠ â€” Ø§Ø­ØªÙØ¸ Ø¨Ù‡ Ø¨Ø£Ù…Ø§Ù†</div>`;
  document.getElementById('dlvHead').style.background=`linear-gradient(135deg,${C.colors.primary},${C.colors.secondary})`;
  document.getElementById('dlvInfo').innerHTML=`
    <div><div class="di-l">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</div><div class="di-v">${orderId}</div></div>
    <div><div class="di-l">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div><div class="di-v">${tot} ${cur}</div></div>
    <div><div class="di-l">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div><div class="di-v">${delivered.map(d=>d.product.name).join('ØŒ ')}</div></div>`;
  let codesHtml='';
  delivered.forEach(d=>{
    if(d.product.codeType==='account'){
      const cp=`${d.code.user} / ${d.code.pass}`;
      codesHtml+=`${delivered.length>1?`<div style="font-size:.75rem;color:rgba(255,255,255,.4);margin:.6rem 0 .3rem;">${d.product.emoji} ${d.product.name}</div>`:''}
        <div class="acc-box">
          <div class="acc-row"><span class="acc-l">Ø§Ù„Ø¨Ø±ÙŠØ¯ / Ø§Ù„ÙŠÙˆØ²Ø±</span><span class="acc-v">${d.code.user}</span></div>
          <div class="acc-row"><span class="acc-l">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</span><span class="acc-v">${d.code.pass}</span></div>
          ${d.code.note?`<div class="acc-row"><span class="acc-l">Ù…Ù„Ø§Ø­Ø¸Ø©</span><span class="acc-v" style="color:var(--ac);">${d.code.note}</span></div>`:''}
        </div>
        <button class="btn-cp" onclick="cpTxt('${cp.replace(/'/g,"\\'")}')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>`;
    }else{
      codesHtml+=`${delivered.length>1?`<div style="font-size:.75rem;color:rgba(255,255,255,.4);margin:.6rem 0 .3rem;">${d.product.emoji} ${d.product.name}</div>`:''}
        <div class="code-box"><div class="code-lbl">Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</div><div class="code-val">${d.code.val}</div></div>
        <button class="btn-cp" onclick="cpTxt('${d.code.val}')">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯</button>`;
    }
  });
  const custMsg=buildMsg(orderId,name,delivered);
  codesHtml+=`<div class="wa-row">
    ${C.delivery.sendOwner?`<button class="btn-wa-o" onclick="notifyOwner('${orderId}','${name}','${email}',${tot},[])">ğŸ”” Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ØªØ¬Ø±</button>`:''}
  </div>`;
  document.getElementById('dlvCodes').innerHTML=codesHtml;
  document.getElementById('dlvOv').classList.add('open');
  if(C.delivery.sendOwner)notifyOwner(orderId,name,email,tot,delivered);
}
function closeDlv(){document.getElementById('dlvOv').classList.remove('open');}
function cpTxt(t){navigator.clipboard.writeText(t).then(()=>showToast('âœ“ ØªÙ… Ø§Ù„Ù†Ø³Ø®!'));}

// â•â•â•â•â•â•â•â• MY ORDERS (Firebase) â•â•â•â•â•â•â•â•
async function openMyOrders(){
  if(!isLoggedIn||!currentUser){openSheet('loginSheet');return;}
  const cur=C.store.currency||'Ø±.Ø³';
  document.getElementById('myOrdersName').textContent=currentUser.name||currentUser.email;
  document.getElementById('myOrdersPhone').textContent=currentUser.email||'';
  document.getElementById('myOrdersJoin').textContent=currentUser.joinDate||'';
  document.getElementById('myOrdersList').innerHTML='<div style="text-align:center;padding:2rem;color:var(--p);"><span class="spin">âŒ›</span> Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§ØªÙƒ...</div>';
  openSheet('myOrdersSheet');

  const orders=await fbGetOrders(currentUser.uid);
  document.getElementById('myOrdersCount').textContent=orders.length+' Ø·Ù„Ø¨';
  document.getElementById('myOrdersList').innerHTML=orders.length
    ?orders.map(o=>`
      <div style="background:#f8f7ff;border:1px solid var(--bd);border-radius:12px;padding:1rem;margin-bottom:.8rem;">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:.6rem;">
          <div><strong style="color:var(--p);font-size:.95rem;">${o.id}</strong> <span style="font-size:.72rem;color:var(--gr);">${o.date}</span></div>
          <span style="font-size:.8rem;font-weight:800;color:var(--p);">${o.total} ${o.currency||cur}</span>
        </div>
        <div style="font-size:.82rem;color:var(--tx2);margin-bottom:.6rem;">${o.products}</div>
        ${o.codes&&o.codes.length?`<div style="background:#fff;border:1px solid rgba(109,40,217,.15);border-radius:8px;padding:.6rem .8rem;">
          ${o.codes.map(c=>c.type==='account'
            ?`<div style="font-size:.78rem;margin-bottom:.3rem;"><span style="color:var(--gr);">${c.product}:</span> ğŸ‘¤ <span style="font-family:monospace;font-weight:700;">${c.user}</span> / <span style="font-family:monospace;">${c.pass}</span>${c.note?` [${c.note}]`:''}</div>`
            :`<div style="font-size:.78rem;margin-bottom:.3rem;"><span style="color:var(--gr);">${c.product}:</span> ğŸ”‘ <span style="font-family:monospace;font-weight:700;color:var(--p);">${c.val}</span></div>`
          ).join('')}
        </div>`:''}
        <div style="display:flex;align-items:center;justify-content:space-between;margin-top:.6rem;">
          <span style="font-size:.73rem;color:var(--gr);">${o.payMethod||''}</span>
          <span style="font-size:.72rem;font-weight:700;color:var(--gn);">âœ“ Ù…ÙƒØªÙ…Ù„</span>
        </div>
      </div>`).join('')
    :'<div style="text-align:center;padding:2rem;color:var(--gr);"><div style="font-size:2.5rem;">ğŸ›’</div><p style="margin-top:.5rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</p></div>';
}

// â•â•â•â•â•â•â•â• TOAST â•â•â•â•â•â•â•â•
let _toastT;
function showToast(msg){const t=document.getElementById('toast');t.textContent=msg;t.classList.add('show');clearTimeout(_toastT);_toastT=setTimeout(()=>t.classList.remove('show'),2600);}

// â”€â”€ LIVE SYNC (localStorage fallback) â”€â”€
window.addEventListener('storage',e=>{if(e.key==='storeConfig'||e.key==='storeProducts')location.reload();});

// â”€â”€ INIT â€” Firestore Ø£ÙˆÙ„Ø§Ù‹ â”€â”€
initStore();

</script>
</body>
</html>
